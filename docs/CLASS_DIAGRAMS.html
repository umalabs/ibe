<!DOCTYPE html><html><head>
      <title>CLASS_DIAGRAMS</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      <link rel="stylesheet" href="file:////home/igor/.vscode/extensions/shd101wyy.markdown-preview-enhanced-0.8.15/crossnote/dependencies/katex/katex.min.css">
      
      
      
      
      
      <style>
      code[class*=language-],pre[class*=language-]{color:#333;background:0 0;font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.4;-moz-tab-size:8;-o-tab-size:8;tab-size:8;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:.8em;overflow:auto;border-radius:3px;background:#f5f5f5}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal;background:#f5f5f5}.token.blockquote,.token.comment{color:#969896}.token.cdata{color:#183691}.token.doctype,.token.macro.property,.token.punctuation,.token.variable{color:#333}.token.builtin,.token.important,.token.keyword,.token.operator,.token.rule{color:#a71d5d}.token.attr-value,.token.regex,.token.string,.token.url{color:#183691}.token.atrule,.token.boolean,.token.code,.token.command,.token.constant,.token.entity,.token.number,.token.property,.token.symbol{color:#0086b3}.token.prolog,.token.selector,.token.tag{color:#63a35c}.token.attr-name,.token.class,.token.class-name,.token.function,.token.id,.token.namespace,.token.pseudo-class,.token.pseudo-element,.token.url-reference .token.variable{color:#795da3}.token.entity{cursor:help}.token.title,.token.title .token.punctuation{font-weight:700;color:#1d3e81}.token.list{color:#ed6a43}.token.inserted{background-color:#eaffea;color:#55a532}.token.deleted{background-color:#ffecec;color:#bd2c00}.token.bold{font-weight:700}.token.italic{font-style:italic}.language-json .token.property{color:#183691}.language-markup .token.tag .token.punctuation{color:#333}.language-css .token.function,code.language-css{color:#0086b3}.language-yaml .token.atrule{color:#63a35c}code.language-yaml{color:#183691}.language-ruby .token.function{color:#333}.language-markdown .token.url{color:#795da3}.language-makefile .token.symbol{color:#795da3}.language-makefile .token.variable{color:#183691}.language-makefile .token.builtin{color:#0086b3}.language-bash .token.keyword{color:#0086b3}pre[data-line]{position:relative;padding:1em 0 1em 3em}pre[data-line] .line-highlight-wrapper{position:absolute;top:0;left:0;background-color:transparent;display:block;width:100%}pre[data-line] .line-highlight{position:absolute;left:0;right:0;padding:inherit 0;margin-top:1em;background:hsla(24,20%,50%,.08);background:linear-gradient(to right,hsla(24,20%,50%,.1) 70%,hsla(24,20%,50%,0));pointer-events:none;line-height:inherit;white-space:pre}pre[data-line] .line-highlight:before,pre[data-line] .line-highlight[data-end]:after{content:attr(data-start);position:absolute;top:.4em;left:.6em;min-width:1em;padding:0 .5em;background-color:hsla(24,20%,50%,.4);color:#f4f1ef;font:bold 65%/1.5 sans-serif;text-align:center;vertical-align:.3em;border-radius:999px;text-shadow:none;box-shadow:0 1px #fff}pre[data-line] .line-highlight[data-end]:after{content:attr(data-end);top:auto;bottom:.4em}html body{font-family:'Helvetica Neue',Helvetica,'Segoe UI',Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ol,html body>ul{margin-bottom:16px}html body ol,html body ul{padding-left:2em}html body ol.no-list,html body ul.no-list{padding:0;list-style-type:none}html body ol ol,html body ol ul,html body ul ol,html body ul ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;background-color:#f0f0f0;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:700;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:700}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::after,html body code::before{letter-spacing:-.2em;content:'\00a0'}html body pre>code{padding:0;margin:0;word-break:normal;white-space:pre;background:0 0;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:after,html body pre code:before,html body pre tt:after,html body pre tt:before{content:normal}html body blockquote,html body dl,html body ol,html body p,html body pre,html body ul{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body code,html body pre{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview ul{list-style:disc}.markdown-preview ul ul{list-style:circle}.markdown-preview ul ul ul{list-style:square}.markdown-preview ol{list-style:decimal}.markdown-preview ol ol,.markdown-preview ul ol{list-style-type:lower-roman}.markdown-preview ol ol ol,.markdown-preview ol ul ol,.markdown-preview ul ol ol,.markdown-preview ul ul ol{list-style-type:lower-alpha}.markdown-preview .newpage,.markdown-preview .pagebreak{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center!important}.markdown-preview:not([data-for=preview]) .code-chunk .code-chunk-btn-group{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .status{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .output-div{margin-bottom:16px}.markdown-preview .md-toc{padding:0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link div,.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}.markdown-preview .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0;min-height:100vh}@media screen and (min-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px + 2em)}}@media screen and (max-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{font-size:14px!important;padding:1em}}@media print{html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc{padding:0 16px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link div,html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% - 300px);padding:2em calc(50% - 457px - 300px / 2);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */

      </style>
      <!-- The content below will be included at the end of the <head> element. --><script type="text/javascript">
  document.addEventListener("DOMContentLoaded", function () {
    // your code here
  });
</script></head><body for="html-export">
    
    
      <div class="crossnote markdown-preview  ">
      
<p><strong>Class Diagram for Encryption Process:</strong></p>
<p class="plantuml"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentstyletype="text/css" data-diagram-type="CLASS" height="1189.3333px" preserveAspectRatio="none" style="width:1867px;height:1189px;background:#FFFFFF;" version="1.1" viewBox="0 0 1867 1189" width="1867.3333px" zoomAndPan="magnify"><defs></defs><g><!--cluster Client Components--><g id="cluster_Client Components"><path d="M569.6667,794.3533 L659.1397,794.3533 A2.5,2.5 0 0 1 660.8063,796.02 L665.473,811.0653 L1345,811.0653 A1.6667,1.6667 0 0 1 1346.6667,812.7319 L1346.6667,1068.6867 A1.6667,1.6667 0 0 1 1345,1070.3533 L569.6667,1070.3533 A1.6667,1.6667 0 0 1 568,1068.6867 L568,796.02 A1.6667,1.6667 0 0 1 569.6667,794.3533 " fill="#ADD8E6" style="stroke:#000000;stroke-width:1;"></path><line style="stroke:#000000;stroke-width:1;" x1="568" x2="665.473" y1="811.0653" y2="811.0653"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" font-weight="bold" lengthAdjust="spacing" textLength="88.8063" x="570.6667" y="805.664">Client Components</text></g><!--cluster RS Components--><g id="cluster_RS Components"><path d="M1085.6667,397.6867 L1159.1051,397.6867 A2.5,2.5 0 0 1 1160.7717,399.3533 L1165.4384,414.3986 L1845.3333,414.3986 A1.6667,1.6667 0 0 1 1847,416.0653 L1847,684.02 A1.6667,1.6667 0 0 1 1845.3333,685.6867 L1085.6667,685.6867 A1.6667,1.6667 0 0 1 1084,684.02 L1084,399.3533 A1.6667,1.6667 0 0 1 1085.6667,397.6867 " fill="#ADD8E6" style="stroke:#000000;stroke-width:1;"></path><line style="stroke:#000000;stroke-width:1;" x1="1084" x2="1165.4384" y1="414.3986" y2="414.3986"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" font-weight="bold" lengthAdjust="spacing" textLength="72.7717" x="1086.6667" y="408.9973">RS Components</text></g><!--class ContentHashGenerator--><g id="elem_ContentHashGenerator"><rect codeline="22" fill="#EEEBDC" height="95.5597" id="ContentHashGenerator" rx="1.6667" ry="1.6667" style="stroke:#181818;stroke-width:0.3333;" width="179.5367" x="578.6667" y="820.02"></rect><ellipse cx="614.3385" cy="830.6867" fill="#ADD1B2" rx="7.3333" ry="7.3333" style="stroke:#181818;stroke-width:0.6667;"></ellipse><path d="M616.3177,834.4471 Q615.9323,834.645 615.5052,834.7388 Q615.0781,834.8429 614.6094,834.8429 Q612.9427,834.8429 612.0573,833.7492 Q611.1823,832.645 611.1823,830.5617 Q611.1823,828.4783 612.0573,827.3742 Q612.9427,826.27 614.6094,826.27 Q615.0781,826.27 615.5052,826.3742 Q615.9427,826.4783 616.3177,826.6763 L616.3177,828.4888 Q615.901,828.1033 615.5052,827.9263 Q615.1094,827.7388 614.6927,827.7388 Q613.7969,827.7388 613.3385,828.4575 Q612.8802,829.1658 612.8802,830.5617 Q612.8802,831.9575 613.3385,832.6763 Q613.7969,833.3846 614.6927,833.3846 Q615.1094,833.3846 615.5052,833.2075 Q615.901,833.02 616.3177,832.6346 L616.3177,834.4471 Z " fill="#000000"></path><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="102.5263" x="628.0052" y="834.308">ContentHashGenerator</text><line style="stroke:#181818;stroke-width:0.3333;" x1="579.3333" x2="757.5367" y1="841.3533" y2="841.3533"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="169.4367" x="582.6667" y="869.3759">algorithm: Algorithm = HMAC-SHA-256</text><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="102.0596" x="582.6667" y="882.0878">contentHashKey: byte[]</text><line style="stroke:#181818;stroke-width:0.6667;" x1="579.3333" x2="646.6464" y1="853.0426" y2="853.0426"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="43.5772" x="646.6464" y="856.3306">Attributes</text><line style="stroke:#181818;stroke-width:0.6667;" x1="690.2236" x2="757.5367" y1="853.0426" y2="853.0426"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="171.5367" x="582.6667" y="910.1784">generateContentHash(plaintext): byte[]</text><line style="stroke:#181818;stroke-width:0.6667;" x1="579.3333" x2="643.9118" y1="893.8451" y2="893.8451"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="49.0465" x="643.9118" y="897.1331">Operations</text><line style="stroke:#181818;stroke-width:0.6667;" x1="692.9583" x2="757.5367" y1="893.8451" y2="893.8451"></line></g><!--class ContentHashKeyRNDGenerator--><g id="elem_ContentHashKeyRNDGenerator"><rect codeline="30" fill="#EEEBDC" height="54.7572" id="ContentHashKeyRNDGenerator" rx="1.6667" ry="1.6667" style="stroke:#181818;stroke-width:0.3333;" width="159.3728" x="1176.6667" y="897.6867"></rect><ellipse cx="1186.6667" cy="908.3533" fill="#ADD1B2" rx="7.3333" ry="7.3333" style="stroke:#181818;stroke-width:0.6667;"></ellipse><path d="M1188.6458,912.1138 Q1188.2604,912.3117 1187.8333,912.4054 Q1187.4063,912.5096 1186.9375,912.5096 Q1185.2708,912.5096 1184.3854,911.4158 Q1183.5104,910.3117 1183.5104,908.2283 Q1183.5104,906.145 1184.3854,905.0408 Q1185.2708,903.9367 1186.9375,903.9367 Q1187.4063,903.9367 1187.8333,904.0408 Q1188.2708,904.145 1188.6458,904.3429 L1188.6458,906.1554 Q1188.2292,905.77 1187.8333,905.5929 Q1187.4375,905.4054 1187.0208,905.4054 Q1186.125,905.4054 1185.6667,906.1242 Q1185.2083,906.8325 1185.2083,908.2283 Q1185.2083,909.6242 1185.6667,910.3429 Q1186.125,911.0513 1187.0208,911.0513 Q1187.4375,911.0513 1187.8333,910.8742 Q1188.2292,910.6867 1188.6458,910.3013 L1188.6458,912.1138 Z " fill="#000000"></path><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="138.0395" x="1196" y="911.9747">ContentHashKeyRNDGenerator</text><line style="stroke:#181818;stroke-width:0.3333;" x1="1177.3333" x2="1335.3728" y1="919.02" y2="919.02"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="91.3636" x="1180.6667" y="947.0426">generateKey(): byte[]</text><line style="stroke:#181818;stroke-width:0.6667;" x1="1177.3333" x2="1231.8298" y1="930.7093" y2="930.7093"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="49.0465" x="1231.8298" y="933.9973">Operations</text><line style="stroke:#181818;stroke-width:0.6667;" x1="1280.8763" x2="1335.3728" y1="930.7093" y2="930.7093"></line></g><!--class ContentEncryption--><g id="elem_ContentEncryption"><rect codeline="35" fill="#EEEBDC" height="120.9836" id="ContentEncryption" rx="1.6667" ry="1.6667" style="stroke:#181818;stroke-width:0.3333;" width="165.3594" x="585.6667" y="938.6867"></rect><ellipse cx="624.4792" cy="949.3533" fill="#ADD1B2" rx="7.3333" ry="7.3333" style="stroke:#181818;stroke-width:0.6667;"></ellipse><path d="M626.4584,953.1138 Q626.0729,953.3117 625.6459,953.4054 Q625.2188,953.5096 624.75,953.5096 Q623.0834,953.5096 622.1979,952.4158 Q621.3229,951.3117 621.3229,949.2283 Q621.3229,947.145 622.1979,946.0408 Q623.0834,944.9367 624.75,944.9367 Q625.2188,944.9367 625.6459,945.0408 Q626.0834,945.145 626.4584,945.3429 L626.4584,947.1554 Q626.0417,946.77 625.6459,946.5929 Q625.25,946.4054 624.8334,946.4054 Q623.9375,946.4054 623.4792,947.1242 Q623.0209,947.8325 623.0209,949.2283 Q623.0209,950.6242 623.4792,951.3429 Q623.9375,952.0513 624.8334,952.0513 Q625.25,952.0513 625.6459,951.8742 Q626.0417,951.6867 626.4584,951.3013 L626.4584,953.1138 Z " fill="#000000"></path><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="82.0677" x="638.1459" y="952.9747">ContentEncryption</text><line style="stroke:#181818;stroke-width:0.3333;" x1="586.3333" x2="750.3594" y1="960.02" y2="960.02"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="157.3594" x="589.6667" y="988.0426">algorithm: Algorithm = AES-256-CTR</text><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="95.1063" x="589.6667" y="1000.7545">contentEncKey: byte[]</text><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="72.6317" x="589.6667" y="1013.4665">contentIV: byte[]</text><line style="stroke:#181818;stroke-width:0.6667;" x1="586.3333" x2="646.5578" y1="971.7093" y2="971.7093"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="43.5772" x="646.5578" y="974.9973">Attributes</text><line style="stroke:#181818;stroke-width:0.6667;" x1="690.1349" x2="750.3594" y1="971.7093" y2="971.7093"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="142.6221" x="589.6667" y="1041.557">encryptContent(plaintext): byte[]</text><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="148.5488" x="589.6667" y="1054.269">decryptContent(ciphertext): byte[]</text><line style="stroke:#181818;stroke-width:0.6667;" x1="586.3333" x2="643.8231" y1="1025.2238" y2="1025.2238"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="49.0465" x="643.8231" y="1028.5117">Operations</text><line style="stroke:#181818;stroke-width:0.6667;" x1="692.8696" x2="750.3594" y1="1025.2238" y2="1025.2238"></line></g><!--class ContentEncKeyRNDGenerator--><g id="elem_ContentEncKeyRNDGenerator"><rect codeline="45" fill="#EEEBDC" height="54.7572" id="ContentEncKeyRNDGenerator" rx="1.6667" ry="1.6667" style="stroke:#181818;stroke-width:0.3333;" width="152.4195" x="1180" y="819.6867"></rect><ellipse cx="1190" cy="830.3533" fill="#ADD1B2" rx="7.3333" ry="7.3333" style="stroke:#181818;stroke-width:0.6667;"></ellipse><path d="M1191.9792,834.1138 Q1191.5938,834.3117 1191.1667,834.4054 Q1190.7396,834.5096 1190.2708,834.5096 Q1188.6042,834.5096 1187.7188,833.4158 Q1186.8438,832.3117 1186.8438,830.2283 Q1186.8438,828.145 1187.7188,827.0408 Q1188.6042,825.9367 1190.2708,825.9367 Q1190.7396,825.9367 1191.1667,826.0408 Q1191.6042,826.145 1191.9792,826.3429 L1191.9792,828.1554 Q1191.5625,827.77 1191.1667,827.5929 Q1190.7708,827.4054 1190.3542,827.4054 Q1189.4583,827.4054 1189,828.1242 Q1188.5417,828.8325 1188.5417,830.2283 Q1188.5417,831.6242 1189,832.3429 Q1189.4583,833.0513 1190.3542,833.0513 Q1190.7708,833.0513 1191.1667,832.8742 Q1191.5625,832.6867 1191.9792,832.3013 L1191.9792,834.1138 Z " fill="#000000"></path><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="131.0861" x="1199.3333" y="833.9747">ContentEncKeyRNDGenerator</text><line style="stroke:#181818;stroke-width:0.3333;" x1="1180.6667" x2="1331.7528" y1="841.02" y2="841.02"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="91.3636" x="1184" y="869.0426">generateKey(): byte[]</text><line style="stroke:#181818;stroke-width:0.6667;" x1="1180.6667" x2="1231.6865" y1="852.7093" y2="852.7093"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="49.0465" x="1231.6865" y="855.9973">Operations</text><line style="stroke:#181818;stroke-width:0.6667;" x1="1280.733" x2="1331.7528" y1="852.7093" y2="852.7093"></line></g><!--class ContentIV_RNDGenerator--><g id="elem_ContentIV_RNDGenerator"><rect codeline="50" fill="#EEEBDC" height="54.7572" id="ContentIV_RNDGenerator" rx="1.6667" ry="1.6667" style="stroke:#181818;stroke-width:0.3333;" width="134.0889" x="1189.3333" y="975.6867"></rect><ellipse cx="1199.3333" cy="986.3533" fill="#ADD1B2" rx="7.3333" ry="7.3333" style="stroke:#181818;stroke-width:0.6667;"></ellipse><path d="M1201.3125,990.1138 Q1200.9271,990.3117 1200.5,990.4054 Q1200.0729,990.5096 1199.6042,990.5096 Q1197.9375,990.5096 1197.0521,989.4158 Q1196.1771,988.3117 1196.1771,986.2283 Q1196.1771,984.145 1197.0521,983.0408 Q1197.9375,981.9367 1199.6042,981.9367 Q1200.0729,981.9367 1200.5,982.0408 Q1200.9375,982.145 1201.3125,982.3429 L1201.3125,984.1554 Q1200.8958,983.77 1200.5,983.5929 Q1200.1042,983.4054 1199.6875,983.4054 Q1198.7917,983.4054 1198.3333,984.1242 Q1197.875,984.8325 1197.875,986.2283 Q1197.875,987.6242 1198.3333,988.3429 Q1198.7917,989.0513 1199.6875,989.0513 Q1200.1042,989.0513 1200.5,988.8742 Q1200.8958,988.6867 1201.3125,988.3013 L1201.3125,990.1138 Z " fill="#000000"></path><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="112.7556" x="1208.6667" y="989.9747">ContentIV_RNDGenerator</text><line style="stroke:#181818;stroke-width:0.3333;" x1="1190" x2="1322.7556" y1="997.02" y2="997.02"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="84.3263" x="1193.3333" y="1025.0426">generateIV(): byte[]</text><line style="stroke:#181818;stroke-width:0.6667;" x1="1190" x2="1231.8545" y1="1008.7093" y2="1008.7093"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="49.0465" x="1231.8545" y="1011.9973">Operations</text><line style="stroke:#181818;stroke-width:0.6667;" x1="1280.901" x2="1322.7556" y1="1008.7093" y2="1008.7093"></line></g><!--class HKDF--><g id="elem_HKDF"><rect codeline="57" fill="#EEEBDC" height="95.5597" id="HKDF" rx="1.6667" ry="1.6667" style="stroke:#181818;stroke-width:0.3333;" width="270.4896" x="1565.6667" y="423.3533"></rect><ellipse cx="1685.9029" cy="434.02" fill="#ADD1B2" rx="7.3333" ry="7.3333" style="stroke:#181818;stroke-width:0.6667;"></ellipse><path d="M1687.882,437.7804 Q1687.4966,437.9783 1687.0695,438.0721 Q1686.6424,438.1763 1686.1737,438.1763 Q1684.507,438.1763 1683.6216,437.0825 Q1682.7466,435.9783 1682.7466,433.895 Q1682.7466,431.8117 1683.6216,430.7075 Q1684.507,429.6033 1686.1737,429.6033 Q1686.6424,429.6033 1687.0695,429.7075 Q1687.507,429.8117 1687.882,430.0096 L1687.882,431.8221 Q1687.4654,431.4367 1687.0695,431.2596 Q1686.6737,431.0721 1686.257,431.0721 Q1685.3612,431.0721 1684.9029,431.7908 Q1684.4445,432.4992 1684.4445,433.895 Q1684.4445,435.2908 1684.9029,436.0096 Q1685.3612,436.7179 1686.257,436.7179 Q1686.6737,436.7179 1687.0695,436.5408 Q1687.4654,436.3533 1687.882,435.9679 L1687.882,437.7804 Z " fill="#000000"></path><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="24.3506" x="1699.5695" y="437.6413">HKDF</text><line style="stroke:#181818;stroke-width:0.3333;" x1="1566.3333" x2="1835.4896" y1="444.6867" y2="444.6867"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="126.5129" x="1569.6667" y="472.7092">algorithm: Algorithm = HKDF</text><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="98.1116" x="1569.6667" y="485.4212">masterKey: MasterKey</text><line style="stroke:#181818;stroke-width:0.6667;" x1="1566.3333" x2="1679.1229" y1="456.376" y2="456.376"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="43.5772" x="1679.1229" y="459.664">Attributes</text><line style="stroke:#181818;stroke-width:0.6667;" x1="1722.7001" x2="1835.4896" y1="456.376" y2="456.376"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="262.4896" x="1569.6667" y="513.5117">deriveIdentityEncKey(identityNonce, userId): IdentityEncKey</text><line style="stroke:#181818;stroke-width:0.6667;" x1="1566.3333" x2="1676.3882" y1="497.1785" y2="497.1785"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="49.0465" x="1676.3882" y="500.4665">Operations</text><line style="stroke:#181818;stroke-width:0.6667;" x1="1725.4347" x2="1835.4896" y1="497.1785" y2="497.1785"></line></g><!--class ContentEncKeyEncryption--><g id="elem_ContentEncKeyEncryption"><rect codeline="65" fill="#EEEBDC" height="159.1194" id="ContentEncKeyEncryption" rx="1.6667" ry="1.6667" style="stroke:#181818;stroke-width:0.3333;" width="323.2602" x="1094.6667" y="513.3533"></rect><ellipse cx="1196.8103" cy="524.02" fill="#ADD1B2" rx="7.3333" ry="7.3333" style="stroke:#181818;stroke-width:0.6667;"></ellipse><path d="M1198.7895,527.7804 Q1198.4041,527.9783 1197.977,528.0721 Q1197.5499,528.1763 1197.0811,528.1763 Q1195.4145,528.1763 1194.5291,527.0825 Q1193.6541,525.9783 1193.6541,523.895 Q1193.6541,521.8117 1194.5291,520.7075 Q1195.4145,519.6033 1197.0811,519.6033 Q1197.5499,519.6033 1197.977,519.7075 Q1198.4145,519.8117 1198.7895,520.0096 L1198.7895,521.8221 Q1198.3728,521.4367 1197.977,521.2596 Q1197.5811,521.0721 1197.1645,521.0721 Q1196.2686,521.0721 1195.8103,521.7908 Q1195.352,522.4992 1195.352,523.895 Q1195.352,525.2908 1195.8103,526.0096 Q1196.2686,526.7179 1197.1645,526.7179 Q1197.5811,526.7179 1197.977,526.5408 Q1198.3728,526.3533 1198.7895,525.9679 L1198.7895,527.7804 Z " fill="#000000"></path><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="113.3062" x="1210.477" y="527.6413">ContentEncKeyEncryption</text><line style="stroke:#181818;stroke-width:0.3333;" x1="1095.3333" x2="1417.2602" y1="534.6867" y2="534.6867"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="161.6247" x="1098.6667" y="562.7092">algorithm: Algorithm = AES-256-GCM</text><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="134.3341" x="1098.6667" y="575.4212">identityEncKey: IdentityEncKey</text><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="72.0531" x="1098.6667" y="588.1331">identityIV: byte[]</text><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="82.0304" x="1098.6667" y="600.8451">identityAAD: byte[]</text><line style="stroke:#181818;stroke-width:0.6667;" x1="1095.3333" x2="1234.5082" y1="546.376" y2="546.376"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="43.5772" x="1234.5082" y="549.664">Attributes</text><line style="stroke:#181818;stroke-width:0.6667;" x1="1278.0853" x2="1417.2602" y1="546.376" y2="546.376"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="315.2602" x="1098.6667" y="628.9356">encryptKey(contentEncKey): {contentEncKeyCiphertext, identityAADTag}</text><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="309.5575" x="1098.6667" y="641.6476">decryptKey(contentEncKeyCiphertext, identityAADTag): ContentEncKey</text><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="118.1689" x="1098.6667" y="654.3595">generateIdentityIV(): byte[]</text><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="137.6568" x="1098.6667" y="667.0715">generateIdentityNonce(): byte[]</text><line style="stroke:#181818;stroke-width:0.6667;" x1="1095.3333" x2="1231.7735" y1="612.6024" y2="612.6024"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="49.0465" x="1231.7735" y="615.8903">Operations</text><line style="stroke:#181818;stroke-width:0.6667;" x1="1280.82" x2="1417.2602" y1="612.6024" y2="612.6024"></line></g><!--class ContentNonceRNDGenerator--><g id="elem_ContentNonceRNDGenerator"><rect codeline="78" fill="#EEEBDC" height="54.7572" id="ContentNonceRNDGenerator" rx="1.6667" ry="1.6667" style="stroke:#181818;stroke-width:0.3333;" width="165.9287" x="1618" y="542.3533"></rect><ellipse cx="1635.4232" cy="553.02" fill="#ADD1B2" rx="7.3333" ry="7.3333" style="stroke:#181818;stroke-width:0.6667;"></ellipse><path d="M1637.4023,556.7804 Q1637.0169,556.9783 1636.5898,557.0721 Q1636.1627,557.1763 1635.694,557.1763 Q1634.0273,557.1763 1633.1419,556.0825 Q1632.2669,554.9783 1632.2669,552.895 Q1632.2669,550.8117 1633.1419,549.7075 Q1634.0273,548.6033 1635.694,548.6033 Q1636.1627,548.6033 1636.5898,548.7075 Q1637.0273,548.8117 1637.4023,549.0096 L1637.4023,550.8221 Q1636.9857,550.4367 1636.5898,550.2596 Q1636.194,550.0721 1635.7773,550.0721 Q1634.8815,550.0721 1634.4232,550.7908 Q1633.9648,551.4992 1633.9648,552.895 Q1633.9648,554.2908 1634.4232,555.0096 Q1634.8815,555.7179 1635.7773,555.7179 Q1636.194,555.7179 1636.5898,555.5408 Q1636.9857,555.3533 1637.4023,554.9679 L1637.4023,556.7804 Z " fill="#000000"></path><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="128.0995" x="1646.4061" y="556.6413">ContentNonceRNDGenerator</text><line style="stroke:#181818;stroke-width:0.3333;" x1="1618.6667" x2="1783.2621" y1="563.6867" y2="563.6867"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="157.9287" x="1622" y="591.7092">generateIV(): byte[] // For Identity IV</text><line style="stroke:#181818;stroke-width:0.6667;" x1="1618.6667" x2="1676.4411" y1="575.376" y2="575.376"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="49.0465" x="1676.4411" y="578.664">Operations</text><line style="stroke:#181818;stroke-width:0.6667;" x1="1725.4876" x2="1783.2621" y1="575.376" y2="575.376"></line></g><!--class IdentityNonceRNDGenerator--><g id="elem_IdentityNonceRNDGenerator"><rect codeline="83" fill="#EEEBDC" height="54.7572" id="IdentityNonceRNDGenerator" rx="1.6667" ry="1.6667" style="stroke:#181818;stroke-width:0.3333;" width="204.9046" x="1598.6667" y="620.3533"></rect><ellipse cx="1634.8565" cy="631.02" fill="#ADD1B2" rx="7.3333" ry="7.3333" style="stroke:#181818;stroke-width:0.6667;"></ellipse><path d="M1636.8357,634.7804 Q1636.4503,634.9783 1636.0232,635.0721 Q1635.5961,635.1763 1635.1274,635.1763 Q1633.4607,635.1763 1632.5753,634.0825 Q1631.7003,632.9783 1631.7003,630.895 Q1631.7003,628.8117 1632.5753,627.7075 Q1633.4607,626.6033 1635.1274,626.6033 Q1635.5961,626.6033 1636.0232,626.7075 Q1636.4607,626.8117 1636.8357,627.0096 L1636.8357,628.8221 Q1636.419,628.4367 1636.0232,628.2596 Q1635.6274,628.0721 1635.2107,628.0721 Q1634.3149,628.0721 1633.8565,628.7908 Q1633.3982,629.4992 1633.3982,630.895 Q1633.3982,632.2908 1633.8565,633.0096 Q1634.3149,633.7179 1635.2107,633.7179 Q1635.6274,633.7179 1636.0232,633.5408 Q1636.419,633.3533 1636.8357,632.9679 L1636.8357,634.7804 Z " fill="#000000"></path><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="126.8582" x="1648.5232" y="634.6413">IdentityNonceRNDGenerator</text><line style="stroke:#181818;stroke-width:0.3333;" x1="1599.3333" x2="1802.9046" y1="641.6867" y2="641.6867"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="196.9046" x="1602.6667" y="669.7092">generateNonce(): byte[] // For Identity Nonce</text><line style="stroke:#181818;stroke-width:0.6667;" x1="1599.3333" x2="1676.5957" y1="653.376" y2="653.376"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="49.0465" x="1676.5957" y="656.664">Operations</text><line style="stroke:#181818;stroke-width:0.6667;" x1="1725.6422" x2="1802.9046" y1="653.376" y2="653.376"></line></g><!--class Client--><g id="elem_Client"><rect codeline="6" fill="#EEEBDC" height="73.8251" id="Client" rx="1.6667" ry="1.6667" style="stroke:#181818;stroke-width:0.3333;" width="90.8143" x="43" y="880.02"></rect><ellipse cx="73.0159" cy="890.6867" fill="#ADD1B2" rx="7.3333" ry="7.3333" style="stroke:#181818;stroke-width:0.6667;"></ellipse><path d="M74.9951,894.4471 Q74.6096,894.645 74.1826,894.7388 Q73.7555,894.8429 73.2867,894.8429 Q71.6201,894.8429 70.7346,893.7492 Q69.8596,892.645 69.8596,890.5617 Q69.8596,888.4783 70.7346,887.3742 Q71.6201,886.27 73.2867,886.27 Q73.7555,886.27 74.1826,886.3742 Q74.6201,886.4783 74.9951,886.6763 L74.9951,888.4888 Q74.5784,888.1033 74.1826,887.9263 Q73.7867,887.7388 73.3701,887.7388 Q72.4742,887.7388 72.0159,888.4575 Q71.5576,889.1658 71.5576,890.5617 Q71.5576,891.9575 72.0159,892.6763 Q72.4742,893.3846 73.3701,893.3846 Q73.7867,893.3846 74.1826,893.2075 Q74.5784,893.02 74.9951,892.6346 L74.9951,894.4471 Z " fill="#000000"></path><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="25.1159" x="86.6826" y="894.308">Client</text><line style="stroke:#181818;stroke-width:0.3333;" x1="43.6667" x2="133.1477" y1="901.3533" y2="901.3533"></line><line style="stroke:#181818;stroke-width:0.6667;" x1="43.6667" x2="66.6186" y1="913.0426" y2="913.0426"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="43.5772" x="66.6186" y="916.3306">Attributes</text><line style="stroke:#181818;stroke-width:0.6667;" x1="110.1958" x2="133.1477" y1="913.0426" y2="913.0426"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="82.8143" x="47" y="948.4438">initiateEncryption()</text><line style="stroke:#181818;stroke-width:0.6667;" x1="43.6667" x2="63.8839" y1="932.1106" y2="932.1106"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="49.0465" x="63.8839" y="935.3985">Operations</text><line style="stroke:#181818;stroke-width:0.6667;" x1="112.9304" x2="133.1477" y1="932.1106" y2="932.1106"></line></g><!--class RS--><g id="elem_RS"><rect codeline="12" fill="#EEEBDC" height="108.2717" id="RS" rx="1.6667" ry="1.6667" style="stroke:#181818;stroke-width:0.3333;" width="576.7712" x="380" y="539.02"></rect><ellipse cx="660.0876" cy="549.6867" fill="#ADD1B2" rx="7.3333" ry="7.3333" style="stroke:#181818;stroke-width:0.6667;"></ellipse><path d="M662.0668,553.4471 Q661.6814,553.645 661.2543,553.7388 Q660.8272,553.8429 660.3585,553.8429 Q658.6918,553.8429 657.8064,552.7492 Q656.9314,551.645 656.9314,549.5617 Q656.9314,547.4783 657.8064,546.3742 Q658.6918,545.27 660.3585,545.27 Q660.8272,545.27 661.2543,545.3742 Q661.6918,545.4783 662.0668,545.6763 L662.0668,547.4888 Q661.6501,547.1033 661.2543,546.9263 Q660.8585,546.7388 660.4418,546.7388 Q659.546,546.7388 659.0876,547.4575 Q658.6293,548.1658 658.6293,549.5617 Q658.6293,550.9575 659.0876,551.6763 Q659.546,552.3846 660.4418,552.3846 Q660.8585,552.3846 661.2543,552.2075 Q661.6501,552.02 662.0668,551.6346 L662.0668,553.4471 Z " fill="#000000"></path><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="10.9293" x="673.7543" y="553.308">RS</text><line style="stroke:#181818;stroke-width:0.3333;" x1="380.6667" x2="956.1046" y1="560.3533" y2="560.3533"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="141.0448" x="384" y="588.3759">masterKey: MasterKey (TPM 2.0)</text><line style="stroke:#181818;stroke-width:0.6667;" x1="380.6667" x2="646.597" y1="572.0426" y2="572.0426"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="43.5772" x="646.597" y="575.3306">Attributes</text><line style="stroke:#181818;stroke-width:0.6667;" x1="690.1742" x2="956.1046" y1="572.0426" y2="572.0426"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="568.7712" x="384" y="616.4665">encryptContentEncKey(contentEncKey, userId, identityNonce, identityAAD): {contentEncKeyCiphertext, identityIV, identityAADTag}</text><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="563.0686" x="384" y="629.1784">decryptContentEncKey(contentEncKeyCiphertext, userId, identityNonce, identityIV, identityAAD, identityAADTag): ContentEncKey</text><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="190.1659" x="384" y="641.8903">validateAuthorization(accessToken): UserID</text><line style="stroke:#181818;stroke-width:0.6667;" x1="380.6667" x2="643.8624" y1="600.1332" y2="600.1332"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="49.0465" x="643.8624" y="603.4212">Operations</text><line style="stroke:#181818;stroke-width:0.6667;" x1="692.9089" x2="956.1046" y1="600.1332" y2="600.1332"></line></g><!--class ContentCiphertext--><g id="elem_ContentCiphertext"><rect fill="#EEEBDC" height="32" id="ContentCiphertext" rx="1.6667" ry="1.6667" style="stroke:#181818;stroke-width:0.3333;" width="102.2904" x="1205.3333" y="751.6867"></rect><ellipse cx="1215.3333" cy="762.3533" fill="#ADD1B2" rx="7.3333" ry="7.3333" style="stroke:#181818;stroke-width:0.6667;"></ellipse><path d="M1217.3125,766.1138 Q1216.9271,766.3117 1216.5,766.4054 Q1216.0729,766.5096 1215.6042,766.5096 Q1213.9375,766.5096 1213.0521,765.4158 Q1212.1771,764.3117 1212.1771,762.2283 Q1212.1771,760.145 1213.0521,759.0408 Q1213.9375,757.9367 1215.6042,757.9367 Q1216.0729,757.9367 1216.5,758.0408 Q1216.9375,758.145 1217.3125,758.3429 L1217.3125,760.1554 Q1216.8958,759.77 1216.5,759.5929 Q1216.1042,759.4054 1215.6875,759.4054 Q1214.7917,759.4054 1214.3333,760.1242 Q1213.875,760.8325 1213.875,762.2283 Q1213.875,763.6242 1214.3333,764.3429 Q1214.7917,765.0513 1215.6875,765.0513 Q1216.1042,765.0513 1216.5,764.8742 Q1216.8958,764.6867 1217.3125,764.3013 L1217.3125,766.1138 Z " fill="#000000"></path><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="80.957" x="1224.6667" y="765.9747">ContentCiphertext</text><line style="stroke:#181818;stroke-width:0.3333;" x1="1206" x2="1306.957" y1="773.02" y2="773.02"></line><line style="stroke:#181818;stroke-width:0.3333;" x1="1206" x2="1306.957" y1="778.3533" y2="778.3533"></line></g><!--class IdentityAADMetadata--><g id="elem_IdentityAADMetadata"><rect fill="#EEEBDC" height="32" id="IdentityAADMetadata" rx="1.6667" ry="1.6667" style="stroke:#181818;stroke-width:0.3333;" width="115.833" x="1198.3333" y="696.3533"></rect><ellipse cx="1208.3333" cy="707.02" fill="#ADD1B2" rx="7.3333" ry="7.3333" style="stroke:#181818;stroke-width:0.6667;"></ellipse><path d="M1210.3125,710.7804 Q1209.9271,710.9783 1209.5,711.0721 Q1209.0729,711.1763 1208.6042,711.1763 Q1206.9375,711.1763 1206.0521,710.0825 Q1205.1771,708.9783 1205.1771,706.895 Q1205.1771,704.8117 1206.0521,703.7075 Q1206.9375,702.6033 1208.6042,702.6033 Q1209.0729,702.6033 1209.5,702.7075 Q1209.9375,702.8117 1210.3125,703.0096 L1210.3125,704.8221 Q1209.8958,704.4367 1209.5,704.2596 Q1209.1042,704.0721 1208.6875,704.0721 Q1207.7917,704.0721 1207.3333,704.7908 Q1206.875,705.4992 1206.875,706.895 Q1206.875,708.2908 1207.3333,709.0096 Q1207.7917,709.7179 1208.6875,709.7179 Q1209.1042,709.7179 1209.5,709.5408 Q1209.8958,709.3533 1210.3125,708.9679 L1210.3125,710.7804 Z " fill="#000000"></path><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="94.4997" x="1217.6667" y="710.6413">IdentityAADMetadata</text><line style="stroke:#181818;stroke-width:0.3333;" x1="1199" x2="1313.4997" y1="717.6867" y2="717.6867"></line><line style="stroke:#181818;stroke-width:0.3333;" x1="1199" x2="1313.4997" y1="723.02" y2="723.02"></line></g><!--class ContentEncKeyCiphertextMetadata--><g id="elem_ContentEncKeyCiphertextMetadata"><rect fill="#EEEBDC" height="32" id="ContentEncKeyCiphertextMetadata" rx="1.6667" ry="1.6667" style="stroke:#181818;stroke-width:0.3333;" width="175.4447" x="1613.3333" y="698.3533"></rect><ellipse cx="1623.3333" cy="709.02" fill="#ADD1B2" rx="7.3333" ry="7.3333" style="stroke:#181818;stroke-width:0.6667;"></ellipse><path d="M1625.3125,712.7804 Q1624.9271,712.9783 1624.5,713.0721 Q1624.0729,713.1763 1623.6042,713.1763 Q1621.9375,713.1763 1621.0521,712.0825 Q1620.1771,710.9783 1620.1771,708.895 Q1620.1771,706.8117 1621.0521,705.7075 Q1621.9375,704.6033 1623.6042,704.6033 Q1624.0729,704.6033 1624.5,704.7075 Q1624.9375,704.8117 1625.3125,705.0096 L1625.3125,706.8221 Q1624.8958,706.4367 1624.5,706.2596 Q1624.1042,706.0721 1623.6875,706.0721 Q1622.7917,706.0721 1622.3333,706.7908 Q1621.875,707.4992 1621.875,708.895 Q1621.875,710.2908 1622.3333,711.0096 Q1622.7917,711.7179 1623.6875,711.7179 Q1624.1042,711.7179 1624.5,711.5408 Q1624.8958,711.3533 1625.3125,710.9679 L1625.3125,712.7804 Z " fill="#000000"></path><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="154.1114" x="1632.6667" y="712.6413">ContentEncKeyCiphertextMetadata</text><line style="stroke:#181818;stroke-width:0.3333;" x1="1614" x2="1788.1114" y1="719.6867" y2="719.6867"></line><line style="stroke:#181818;stroke-width:0.3333;" x1="1614" x2="1788.1114" y1="725.02" y2="725.02"></line></g><!--class IdentityIVMetadata--><g id="elem_IdentityIVMetadata"><rect fill="#EEEBDC" height="32" id="IdentityIVMetadata" rx="1.6667" ry="1.6667" style="stroke:#181818;stroke-width:0.3333;" width="105.8557" x="1648" y="753.6867"></rect><ellipse cx="1658" cy="764.3533" fill="#ADD1B2" rx="7.3333" ry="7.3333" style="stroke:#181818;stroke-width:0.6667;"></ellipse><path d="M1659.9792,768.1138 Q1659.5938,768.3117 1659.1667,768.4054 Q1658.7396,768.5096 1658.2708,768.5096 Q1656.6042,768.5096 1655.7188,767.4158 Q1654.8438,766.3117 1654.8438,764.2283 Q1654.8438,762.145 1655.7188,761.0408 Q1656.6042,759.9367 1658.2708,759.9367 Q1658.7396,759.9367 1659.1667,760.0408 Q1659.6042,760.145 1659.9792,760.3429 L1659.9792,762.1554 Q1659.5625,761.77 1659.1667,761.5929 Q1658.7708,761.4054 1658.3542,761.4054 Q1657.4583,761.4054 1657,762.1242 Q1656.5417,762.8325 1656.5417,764.2283 Q1656.5417,765.6242 1657,766.3429 Q1657.4583,767.0513 1658.3542,767.0513 Q1658.7708,767.0513 1659.1667,766.8742 Q1659.5625,766.6867 1659.9792,766.3013 L1659.9792,768.1138 Z " fill="#000000"></path><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="84.5224" x="1667.3333" y="767.9747">IdentityIVMetadata</text><line style="stroke:#181818;stroke-width:0.3333;" x1="1648.6667" x2="1753.189" y1="775.02" y2="775.02"></line><line style="stroke:#181818;stroke-width:0.3333;" x1="1648.6667" x2="1753.189" y1="780.3533" y2="780.3533"></line></g><!--class IdentityAADTagMetadata--><g id="elem_IdentityAADTagMetadata"><rect fill="#EEEBDC" height="32" id="IdentityAADTagMetadata" rx="1.6667" ry="1.6667" style="stroke:#181818;stroke-width:0.3333;" width="131.9983" x="1635" y="809.02"></rect><ellipse cx="1645" cy="819.6867" fill="#ADD1B2" rx="7.3333" ry="7.3333" style="stroke:#181818;stroke-width:0.6667;"></ellipse><path d="M1646.9792,823.4471 Q1646.5938,823.645 1646.1667,823.7388 Q1645.7396,823.8429 1645.2708,823.8429 Q1643.6042,823.8429 1642.7188,822.7492 Q1641.8438,821.645 1641.8438,819.5617 Q1641.8438,817.4783 1642.7188,816.3742 Q1643.6042,815.27 1645.2708,815.27 Q1645.7396,815.27 1646.1667,815.3742 Q1646.6042,815.4783 1646.9792,815.6763 L1646.9792,817.4888 Q1646.5625,817.1033 1646.1667,816.9263 Q1645.7708,816.7388 1645.3542,816.7388 Q1644.4583,816.7388 1644,817.4575 Q1643.5417,818.1658 1643.5417,819.5617 Q1643.5417,820.9575 1644,821.6763 Q1644.4583,822.3846 1645.3542,822.3846 Q1645.7708,822.3846 1646.1667,822.2075 Q1646.5625,822.02 1646.9792,821.6346 L1646.9792,823.4471 Z " fill="#000000"></path><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="110.6649" x="1654.3333" y="823.308">IdentityAADTagMetadata</text><line style="stroke:#181818;stroke-width:0.3333;" x1="1635.6667" x2="1766.3316" y1="830.3533" y2="830.3533"></line><line style="stroke:#181818;stroke-width:0.3333;" x1="1635.6667" x2="1766.3316" y1="835.6867" y2="835.6867"></line></g><!--class ContentHashKeyMetadata--><g id="elem_ContentHashKeyMetadata"><rect fill="#EEEBDC" height="32" id="ContentHashKeyMetadata" rx="1.6667" ry="1.6667" style="stroke:#181818;stroke-width:0.3333;" width="136.5249" x="1632.6667" y="909.02"></rect><ellipse cx="1642.6667" cy="919.6867" fill="#ADD1B2" rx="7.3333" ry="7.3333" style="stroke:#181818;stroke-width:0.6667;"></ellipse><path d="M1644.6458,923.4471 Q1644.2604,923.645 1643.8333,923.7388 Q1643.4063,923.8429 1642.9375,923.8429 Q1641.2708,923.8429 1640.3854,922.7492 Q1639.5104,921.645 1639.5104,919.5617 Q1639.5104,917.4783 1640.3854,916.3742 Q1641.2708,915.27 1642.9375,915.27 Q1643.4063,915.27 1643.8333,915.3742 Q1644.2708,915.4783 1644.6458,915.6763 L1644.6458,917.4888 Q1644.2292,917.1033 1643.8333,916.9263 Q1643.4375,916.7388 1643.0208,916.7388 Q1642.125,916.7388 1641.6667,917.4575 Q1641.2083,918.1658 1641.2083,919.5617 Q1641.2083,920.9575 1641.6667,921.6763 Q1642.125,922.3846 1643.0208,922.3846 Q1643.4375,922.3846 1643.8333,922.2075 Q1644.2292,922.02 1644.6458,921.6346 L1644.6458,923.4471 Z " fill="#000000"></path><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="115.1916" x="1652" y="923.308">ContentHashKeyMetadata</text><line style="stroke:#181818;stroke-width:0.3333;" x1="1633.3333" x2="1768.5249" y1="930.3533" y2="930.3533"></line><line style="stroke:#181818;stroke-width:0.3333;" x1="1633.3333" x2="1768.5249" y1="935.6867" y2="935.6867"></line></g><!--class ContentIVMetadata--><g id="elem_ContentIVMetadata"><rect fill="#EEEBDC" height="32" id="ContentIVMetadata" rx="1.6667" ry="1.6667" style="stroke:#181818;stroke-width:0.3333;" width="107.097" x="1647.3333" y="987.02"></rect><ellipse cx="1657.3333" cy="997.6867" fill="#ADD1B2" rx="7.3333" ry="7.3333" style="stroke:#181818;stroke-width:0.6667;"></ellipse><path d="M1659.3125,1001.4471 Q1658.9271,1001.645 1658.5,1001.7388 Q1658.0729,1001.8429 1657.6042,1001.8429 Q1655.9375,1001.8429 1655.0521,1000.7492 Q1654.1771,999.645 1654.1771,997.5617 Q1654.1771,995.4783 1655.0521,994.3742 Q1655.9375,993.27 1657.6042,993.27 Q1658.0729,993.27 1658.5,993.3742 Q1658.9375,993.4783 1659.3125,993.6763 L1659.3125,995.4888 Q1658.8958,995.1033 1658.5,994.9263 Q1658.1042,994.7388 1657.6875,994.7388 Q1656.7917,994.7388 1656.3333,995.4575 Q1655.875,996.1658 1655.875,997.5617 Q1655.875,998.9575 1656.3333,999.6763 Q1656.7917,1000.3846 1657.6875,1000.3846 Q1658.1042,1000.3846 1658.5,1000.2075 Q1658.8958,1000.02 1659.3125,999.6346 L1659.3125,1001.4471 Z " fill="#000000"></path><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="85.7637" x="1666.6667" y="1001.308">ContentIVMetadata</text><line style="stroke:#181818;stroke-width:0.3333;" x1="1648" x2="1753.7637" y1="1008.3533" y2="1008.3533"></line><line style="stroke:#181818;stroke-width:0.3333;" x1="1648" x2="1753.7637" y1="1013.6867" y2="1013.6867"></line></g><g id="elem_GMN45"><path d="M4,837.6867 L4,856.1573 A0,0 0 0 0 4,856.1573 L85.6667,856.1573 L88.3333,879.8333 L91,856.1573 L172.8735,856.1573 A0,0 0 0 0 172.8735,856.1573 L172.8735,844.3533 L166.2068,837.6867 L4,837.6867 A0,0 0 0 0 4,837.6867 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.3333;"></path><path d="M166.2068,837.6867 L166.2068,844.3533 L172.8735,844.3533 L166.2068,837.6867 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.3333;"></path><text fill="#000000" font-family="sans-serif" font-size="8.6667" lengthAdjust="spacing" textLength="154.8735" x="8" y="850.2847">Represents the Client Application Role</text></g><g id="elem_GMN48"><path d="M546.6667,413.02 L546.6667,431.4907 L789.6749,431.4907 L789.6749,419.6867 L783.0082,413.02 L546.6667,413.02 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.3333;"></path><path d="M783.0082,413.02 L783.0082,419.6867 L789.6749,419.6867 L783.0082,413.02 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.6667;"></path><text fill="#000000" font-family="sans-serif" font-size="8.6667" lengthAdjust="spacing" textLength="229.0082" x="550.6667" y="425.618">Represents the Resource Server (Keyring - RS2/RS3) Role</text></g><g id="elem_GMN51"><path d="M599.6667,455.02 L599.6667,473.4907 L737.3141,473.4907 L737.3141,461.6867 L730.6474,455.02 L599.6667,455.02 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.3333;"></path><path d="M730.6474,455.02 L730.6474,461.6867 L737.3141,461.6867 L730.6474,455.02 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.6667;"></path><text fill="#000000" font-family="sans-serif" font-size="8.6667" lengthAdjust="spacing" textLength="123.6474" x="603.6667" y="467.618">Generates hash of the content</text></g><g id="elem_GMN54"><path d="M1161.6667,326.3533 L1161.6667,344.824 L1351.1062,344.824 L1351.1062,333.02 L1344.4395,326.3533 L1161.6667,326.3533 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.3333;"></path><path d="M1344.4395,326.3533 L1344.4395,333.02 L1351.1062,333.02 L1344.4395,326.3533 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.6667;"></path><text fill="#000000" font-family="sans-serif" font-size="8.6667" lengthAdjust="spacing" textLength="175.4395" x="1165.6667" y="338.9513">Generates random key for content hashing</text></g><g id="elem_GMN57"><path d="M580.6667,497.02 L580.6667,515.4907 L756.1702,515.4907 L756.1702,503.6867 L749.5035,497.02 L580.6667,497.02 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.3333;"></path><path d="M749.5035,497.02 L749.5035,503.6867 L756.1702,503.6867 L749.5035,497.02 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.6667;"></path><text fill="#000000" font-family="sans-serif" font-size="8.6667" lengthAdjust="spacing" textLength="161.5035" x="584.6667" y="509.618">Encrypts and decrypts content plaintext</text></g><g id="elem_GMN60"><path d="M1162,284.3533 L1162,302.824 L1350.4168,302.824 L1350.4168,291.02 L1343.7502,284.3533 L1162,284.3533 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.3333;"></path><path d="M1343.7502,284.3533 L1343.7502,291.02 L1350.4168,291.02 L1343.7502,284.3533 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.6667;"></path><text fill="#000000" font-family="sans-serif" font-size="8.6667" lengthAdjust="spacing" textLength="174.4168" x="1166" y="296.9513">Generates random Content Encryption Key</text></g><g id="elem_GMN63"><path d="M1188.3333,368.3533 L1188.3333,386.824 L1324.3341,386.824 L1324.3341,375.02 L1317.6674,368.3533 L1188.3333,368.3533 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.3333;"></path><path d="M1317.6674,368.3533 L1317.6674,375.02 L1324.3341,375.02 L1317.6674,368.3533 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.6667;"></path><text fill="#000000" font-family="sans-serif" font-size="8.6667" lengthAdjust="spacing" textLength="122.0008" x="1192.3333" y="380.9513">Generates random Content IV</text></g><g id="elem_GMN66"><path d="M1538.6667,284.3533 L1538.6667,302.824 L1863.2195,302.824 L1863.2195,291.02 L1856.5528,284.3533 L1538.6667,284.3533 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.3333;"></path><path d="M1856.5528,284.3533 L1856.5528,291.02 L1863.2195,291.02 L1856.5528,284.3533 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.6667;"></path><text fill="#000000" font-family="sans-serif" font-size="8.6667" lengthAdjust="spacing" textLength="310.5528" x="1542.6667" y="296.9513">Derives Identity Encryption Key from Master Key, Identity nonce and User ID</text></g><g id="elem_GMN69"><path d="M1122.3333,242.3533 L1122.3333,260.824 L1390.0849,260.824 L1390.0849,249.02 L1383.4182,242.3533 L1122.3333,242.3533 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.3333;"></path><path d="M1383.4182,242.3533 L1383.4182,249.02 L1390.0849,249.02 L1383.4182,242.3533 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.6667;"></path><text fill="#000000" font-family="sans-serif" font-size="8.6667" lengthAdjust="spacing" textLength="253.7515" x="1126.3333" y="254.9513">Encrypts Content Encryption Key using Identity Encryption Key</text></g><g id="elem_GMN72"><path d="M1613,326.3533 L1613,344.824 L1789.1621,344.824 L1789.1621,333.02 L1782.4955,326.3533 L1613,326.3533 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.3333;"></path><path d="M1782.4955,326.3533 L1782.4955,333.02 L1789.1621,333.02 L1782.4955,326.3533 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.6667;"></path><text fill="#000000" font-family="sans-serif" font-size="8.6667" lengthAdjust="spacing" textLength="162.1621" x="1617" y="338.9513">Generates random nonce for Identity IV</text></g><g id="elem_GMN75"><path d="M1625,368.3533 L1625,386.824 L1776.7135,386.824 L1776.7135,375.02 L1770.0468,368.3533 L1625,368.3533 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.3333;"></path><path d="M1770.0468,368.3533 L1770.0468,375.02 L1776.7135,375.02 L1770.0468,368.3533 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.6667;"></path><text fill="#000000" font-family="sans-serif" font-size="8.6667" lengthAdjust="spacing" textLength="137.7135" x="1629" y="380.9513">Generates random Identity nonce</text></g><!--link Client to ContentHashGenerator--><g id="link_Client_ContentHashGenerator"><path codeline="89" d="M133.6867,913.2133 C228.86,905.1 445.1222,886.6595 570.6422,875.9595 " fill="transparent" id="Client-to-ContentHashGenerator" style="stroke:#181818;stroke-width:0.6667;"></path><polygon fill="#181818" points="578.6133,875.28,574.4013,872.9627,570.6422,875.9595,574.8543,878.2768,578.6133,875.28" style="stroke:#181818;stroke-width:0.6667;"></polygon><text fill="#000000" font-family="sans-serif" font-size="8.6667" lengthAdjust="spacing" textLength="18.5467" x="267.3333" y="892.9513">uses</text></g><!--link Client to ContentHashKeyRNDGenerator--><g id="link_Client_ContentHashKeyRNDGenerator"><path codeline="90" d="M133.7933,952.74 C188.2667,993.6667 284.7733,1058.3533 380,1083.6867 C503.84,1116.64 838.0733,1132.24 956.6667,1083.6867 C1027.0533,1054.8733 1011.78,999.8933 1078.6667,963.6867 C1108.54,947.52 1136.829,939.4689 1168.6624,933.9956 " fill="transparent" id="Client-to-ContentHashKeyRNDGenerator" style="stroke:#181818;stroke-width:0.6667;"></path><polygon fill="#181818" points="1176.5467,932.64,1172.1526,930.6897,1168.6624,933.9956,1173.0564,935.9459,1176.5467,932.64" style="stroke:#181818;stroke-width:0.6667;"></polygon><text fill="#000000" font-family="sans-serif" font-size="8.6667" lengthAdjust="spacing" textLength="18.5467" x="659.3333" y="1080.9513">uses</text></g><!--link Client to ContentEncryption--><g id="link_Client_ContentEncryption"><path codeline="91" d="M133.6867,923.3533 C230.6467,937.0933 453.6525,968.6976 577.6658,986.2709 " fill="transparent" id="Client-to-ContentEncryption" style="stroke:#181818;stroke-width:0.6667;"></path><polygon fill="#181818" points="585.5867,987.3933,582.0004,984.1918,577.6658,986.2709,581.2521,989.4724,585.5867,987.3933" style="stroke:#181818;stroke-width:0.6667;"></polygon><text fill="#000000" font-family="sans-serif" font-size="8.6667" lengthAdjust="spacing" textLength="18.5467" x="267.3333" y="930.2847">uses</text></g><!--link Client to ContentEncKeyRNDGenerator--><g id="link_Client_ContentEncKeyRNDGenerator"><path codeline="92" d="M133.7133,896.0333 C189.8733,870.6867 289.8267,828.9 380,808.3533 C530.7133,774.0133 957.4533,650.06 1073.3333,752.3533 C1087.66,765.0067 1066.2867,780.4667 1078.6667,795.02 C1103.5667,824.3 1136.1162,836.2814 1172.0628,842.1014 " fill="transparent" id="Client-to-ContentEncKeyRNDGenerator" style="stroke:#181818;stroke-width:0.6667;"></path><polygon fill="#181818" points="1179.96,843.38,1176.4376,840.1083,1172.0628,842.1014,1175.5852,845.3731,1179.96,843.38" style="stroke:#181818;stroke-width:0.6667;"></polygon><text fill="#000000" font-family="sans-serif" font-size="8.6667" lengthAdjust="spacing" textLength="18.5467" x="659.3333" y="710.2847">uses</text></g><!--link Client to ContentIV_RNDGenerator--><g id="link_Client_ContentIV_RNDGenerator"><path codeline="93" d="M102.7533,954.14 C118.6733,991.98 148.4933,1049.64 192.6667,1082.3533 C261.98,1133.6867 294.5,1121.6667 380,1133.02 C634.0667,1166.7733 705.74,1185.2133 956.6667,1133.02 C1051.0133,1113.4 1145.132,1066.2865 1202.272,1034.3132 " fill="transparent" id="Client-to-ContentIV_RNDGenerator" style="stroke:#181818;stroke-width:0.6667;"></path><polygon fill="#181818" points="1209.2533,1030.4067,1204.4605,1030.0328,1202.272,1034.3132,1207.0648,1034.687,1209.2533,1030.4067" style="stroke:#181818;stroke-width:0.6667;"></polygon><text fill="#000000" font-family="sans-serif" font-size="8.6667" lengthAdjust="spacing" textLength="18.5467" x="659.3333" y="1130.2847">uses</text></g><!--link RS to HKDF--><g id="link_RS_HKDF"><path codeline="95" d="M945.4267,538.9733 C949.3667,535.22 953.12,531.24 956.6667,527.02 C1010.7067,462.7533 921.6133,213.0933 976.6667,149.6867 C1006.9533,114.8067 1032.6867,134.1533 1078.6667,129.6867 C1273.5333,110.7667 1389.3733,4 1518.6667,151.02 C1555.08,192.4333 1506.8733,353.3 1538.6667,398.3533 C1546.0267,408.7933 1548.8449,412.9646 1559.1315,420.6513 " fill="transparent" id="RS-to-HKDF" style="stroke:#181818;stroke-width:0.6667;"></path><polygon fill="#181818" points="1565.54,425.44,1563.932,420.9095,1559.1315,420.6513,1560.7395,425.1818,1565.54,425.44" style="stroke:#181818;stroke-width:0.6667;"></polygon><text fill="#000000" font-family="sans-serif" font-size="8.6667" lengthAdjust="spacing" textLength="18.5467" x="1247.3333" y="72.2847">uses</text></g><!--link RS to ContentEncKeyEncryption--><g id="link_RS_ContentEncKeyEncryption"><path codeline="96" d="M956.7467,593.02 C1004.1733,593.02 1043.7867,593.02 1086.64,593.02 " fill="transparent" id="RS-to-ContentEncKeyEncryption" style="stroke:#181818;stroke-width:0.6667;"></path><polygon fill="#181818" points="1094.64,593.02,1090.64,590.3533,1086.64,593.02,1090.64,595.6867,1094.64,593.02" style="stroke:#181818;stroke-width:0.6667;"></polygon><text fill="#000000" font-family="sans-serif" font-size="8.6667" lengthAdjust="spacing" textLength="18.5467" x="1016" y="590.2847">uses</text></g><!--link RS to ContentNonceRNDGenerator--><g id="link_RS_ContentNonceRNDGenerator"><path codeline="97" d="M945.4,538.9467 C949.3533,535.2 953.1133,531.2333 956.6667,527.02 C1006.74,467.7267 920.4133,231.8267 976.6667,178.3533 C1020.32,136.8667 1475.0267,136.8533 1518.6667,178.3533 C1547.0533,205.3533 1513.6,500.2533 1538.6667,530.3533 C1558.0333,553.6067 1580.7121,563.1601 1610.0921,567.8201 " fill="transparent" id="RS-to-ContentNonceRNDGenerator" style="stroke:#181818;stroke-width:0.6667;"></path><polygon fill="#181818" points="1617.9933,569.0733,1614.4605,565.813,1610.0921,567.8201,1613.625,571.0805,1617.9933,569.0733" style="stroke:#181818;stroke-width:0.6667;"></polygon><text fill="#000000" font-family="sans-serif" font-size="8.6667" lengthAdjust="spacing" textLength="18.5467" x="1247.3333" y="144.9513">uses</text></g><!--link RS to IdentityNonceRNDGenerator--><g id="link_RS_IdentityNonceRNDGenerator"><path codeline="98" d="M941.1,538.94 C946.48,535.2133 951.68,531.2467 956.6667,527.02 C1065.42,434.8467 960.2267,309.7133 1078.6667,230.3533 C1141.3133,188.38 1357.1067,185.8733 1418,230.3533 C1560.4067,334.38 1409.66,488.12 1538.6667,608.3533 C1555.2,623.7667 1569.0164,631.324 1590.9431,637.3174 " fill="transparent" id="RS-to-IdentityNonceRNDGenerator" style="stroke:#181818;stroke-width:0.6667;"></path><polygon fill="#181818" points="1598.66,639.4267,1595.5046,635.7997,1590.9431,637.3174,1594.0984,640.9443,1598.66,639.4267" style="stroke:#181818;stroke-width:0.6667;"></polygon><text fill="#000000" font-family="sans-serif" font-size="8.6667" lengthAdjust="spacing" textLength="18.5467" x="1247.3333" y="195.618">uses</text></g><!--link ContentHashGenerator to ContentHashKeyRNDGenerator--><g id="link_ContentHashGenerator_ContentHashKeyRNDGenerator"><path codeline="100" d="M758.1,876.4 C872.0533,887.5333 1067.64,906.6467 1176.56,917.2933 " fill="transparent" id="ContentHashGenerator-ContentHashKeyRNDGenerator" style="stroke:#181818;stroke-width:0.6667;"></path></g><!--link ContentEncryption to ContentEncKeyRNDGenerator--><g id="link_ContentEncryption_ContentEncKeyRNDGenerator"><path codeline="101" d="M751.0067,980.3733 C808.82,966.7733 887.8867,947.2467 956.6667,927.02 C1011.5933,910.8733 1023.5067,901.0067 1078.6667,885.6867 C1111.5467,876.56 1148.3533,868.22 1179.8467,861.6467 " fill="transparent" id="ContentEncryption-ContentEncKeyRNDGenerator" style="stroke:#181818;stroke-width:0.6667;"></path></g><!--link ContentEncryption to ContentIV_RNDGenerator--><g id="link_ContentEncryption_ContentIV_RNDGenerator"><path codeline="102" d="M751.1933,999.58 C868.42,1000.38 1081.3667,1001.8333 1189.2333,1002.5667 " fill="transparent" id="ContentEncryption-ContentIV_RNDGenerator" style="stroke:#181818;stroke-width:0.6667;"></path></g><!--link ContentEncKeyEncryption to HKDF--><g id="link_ContentEncKeyEncryption_HKDF"><path codeline="103" d="M1418.3067,548.6333 C1466.6467,535.3333 1519.1333,520.8867 1565.5733,508.1067 " fill="transparent" id="ContentEncKeyEncryption-HKDF" style="stroke:#181818;stroke-width:0.6667;"></path></g><!--link ContentEncKeyEncryption to ContentNonceRNDGenerator--><g id="link_ContentEncKeyEncryption_ContentNonceRNDGenerator"><path codeline="104" d="M1418.3067,584.5333 C1486.02,580.9667 1561.8667,576.98 1617.8333,574.0333 " fill="transparent" id="ContentEncKeyEncryption-ContentNonceRNDGenerator" style="stroke:#181818;stroke-width:0.6667;"></path></g><!--link ContentEncKeyEncryption to IdentityNonceRNDGenerator--><g id="link_ContentEncKeyEncryption_IdentityNonceRNDGenerator"><path codeline="105" d="M1418.3067,612.9133 C1478.4667,620.3333 1545.0533,628.54 1598.4067,635.12 " fill="transparent" id="ContentEncKeyEncryption-IdentityNonceRNDGenerator" style="stroke:#181818;stroke-width:0.6667;"></path></g><!--link ContentEncryption to ContentCiphertext--><g id="link_ContentEncryption_ContentCiphertext"><path codeline="107" d="M751.2733,993.86 C812.5267,986.5533 895.7333,969.02 956.6667,927.02 C969.46,918.2067 966.3,909.9267 976.6667,898.3533 C1016.8667,853.4667 1025.06,836.5467 1078.6667,809.02 C1118.46,788.5933 1164.4941,778.683 1201.1874,773.403 " fill="transparent" id="ContentEncryption-to-ContentCiphertext" style="stroke:#181818;stroke-width:0.6667;stroke-dasharray:7.0,7.0;"></path><polygon fill="#181818" points="1205.1467,772.8333,1198.828,771.0484,1201.8473,773.3081,1199.5876,776.3274,1205.1467,772.8333" style="stroke:#181818;stroke-width:0.6667;"></polygon><text fill="#000000" font-family="sans-serif" font-size="8.6667" lengthAdjust="spacing" textLength="79.6901" x="985.3333" y="809.618">output generates</text></g><!--link ContentHashGenerator to IdentityAADMetadata--><g id="link_ContentHashGenerator_IdentityAADMetadata"><path codeline="108" d="M758.0467,835.62 C840.32,807.0133 966.4333,765.7333 1078.6667,739.6867 C1118.1933,730.52 1159.4475,724.1153 1194.2942,719.5287 " fill="transparent" id="ContentHashGenerator-to-IdentityAADMetadata" style="stroke:#181818;stroke-width:0.6667;stroke-dasharray:7.0,7.0;"></path><polygon fill="#181818" points="1198.26,719.0067,1191.9633,717.1458,1194.9552,719.4417,1192.6593,722.4335,1198.26,719.0067" style="stroke:#181818;stroke-width:0.6667;"></polygon><text fill="#000000" font-family="sans-serif" font-size="8.6667" lengthAdjust="spacing" textLength="95.8014" x="977.3333" y="739.618">output contributes to</text></g><!--link ContentEncKeyEncryption to ContentEncKeyCiphertextMetadata--><g id="link_ContentEncKeyEncryption_ContentEncKeyCiphertextMetadata"><path codeline="109" d="M1418.0067,650.36 C1457.1733,663.0933 1499.1667,675.7467 1538.6667,685.6867 C1562.6467,691.7267 1585.0009,696.2712 1609.2809,700.5579 " fill="transparent" id="ContentEncKeyEncryption-to-ContentEncKeyCiphertextMetadata" style="stroke:#181818;stroke-width:0.6667;stroke-dasharray:7.0,7.0;"></path><polygon fill="#181818" points="1613.22,701.2533,1607.775,697.5841,1609.9374,700.6738,1606.8477,702.8362,1613.22,701.2533" style="stroke:#181818;stroke-width:0.6667;"></polygon><text fill="#000000" font-family="sans-serif" font-size="8.6667" lengthAdjust="spacing" textLength="79.6901" x="1438.6667" y="656.2847">output generates</text></g><!--link ContentEncKeyEncryption to IdentityIVMetadata--><g id="link_ContentEncKeyEncryption_IdentityIVMetadata"><path codeline="110" d="M1398.9067,672.7733 C1405.3867,676.6467 1411.7733,680.52 1418,684.3533 C1427.0933,689.96 1428.6267,692.5667 1438,697.6867 C1480.8467,721.1 1491.9,727.6467 1538.6667,741.6867 C1574.4067,752.4267 1611.9365,758.9675 1643.9365,763.3208 " fill="transparent" id="ContentEncKeyEncryption-to-IdentityIVMetadata" style="stroke:#181818;stroke-width:0.6667;stroke-dasharray:7.0,7.0;"></path><polygon fill="#181818" points="1647.9,763.86,1642.3142,760.4089,1644.5971,763.4107,1641.5953,765.6935,1647.9,763.86" style="stroke:#181818;stroke-width:0.6667;"></polygon><text fill="#000000" font-family="sans-serif" font-size="8.6667" lengthAdjust="spacing" textLength="79.6901" x="1438.6667" y="694.9513">output generates</text></g><!--link ContentEncKeyEncryption to IdentityAADTagMetadata--><g id="link_ContentEncKeyEncryption_IdentityAADTagMetadata"><path codeline="111" d="M1407.78,672.6933 C1411.3933,676.44 1414.8133,680.32 1418,684.3533 C1437.7133,709.2867 1417.0133,729.1467 1438,753.02 C1470.2333,789.7 1491.9,782.98 1538.6667,797.02 C1569.7667,806.3667 1601.27,812.3526 1631.0434,816.7726 " fill="transparent" id="ContentEncKeyEncryption-to-IdentityAADTagMetadata" style="stroke:#181818;stroke-width:0.6667;stroke-dasharray:7.0,7.0;"></path><polygon fill="#181818" points="1635,817.36,1629.4566,813.8412,1631.7028,816.8705,1628.6735,819.1167,1635,817.36" style="stroke:#181818;stroke-width:0.6667;"></polygon><text fill="#000000" font-family="sans-serif" font-size="8.6667" lengthAdjust="spacing" textLength="79.6901" x="1438.6667" y="750.2847">output generates</text></g><!--link ContentHashKeyRNDGenerator to ContentHashKeyMetadata--><g id="link_ContentHashKeyRNDGenerator_ContentHashKeyMetadata"><path codeline="112" d="M1336.0067,925.02 C1420.3933,925.02 1548.7533,925.02 1628.56,925.02 " fill="transparent" id="ContentHashKeyRNDGenerator-to-ContentHashKeyMetadata" style="stroke:#181818;stroke-width:0.6667;stroke-dasharray:7.0,7.0;"></path><polygon fill="#181818" points="1632.56,925.02,1626.56,922.3533,1629.2267,925.02,1626.56,927.6867,1632.56,925.02" style="stroke:#181818;stroke-width:0.6667;"></polygon><text fill="#000000" font-family="sans-serif" font-size="8.6667" lengthAdjust="spacing" textLength="79.6901" x="1438.6667" y="922.2847">output generates</text></g><!--link ContentIV_RNDGenerator to ContentIVMetadata--><g id="link_ContentIV_RNDGenerator_ContentIVMetadata"><path codeline="113" d="M1323.3733,1003.02 C1411.66,1003.02 1562,1003.02 1643.0933,1003.02 " fill="transparent" id="ContentIV_RNDGenerator-to-ContentIVMetadata" style="stroke:#181818;stroke-width:0.6667;stroke-dasharray:7.0,7.0;"></path><polygon fill="#181818" points="1647.0933,1003.02,1641.0933,1000.3533,1643.76,1003.02,1641.0933,1005.6867,1647.0933,1003.02" style="stroke:#181818;stroke-width:0.6667;"></polygon><text fill="#000000" font-family="sans-serif" font-size="8.6667" lengthAdjust="spacing" textLength="79.6901" x="1438.6667" y="1000.2847">output generates</text></g><!--link Client to RS--><g id="link_Client_RS"><path codeline="115" d="M133.7267,900.1533 C148.38,892.44 163.2867,881.8067 172.6667,867.6867 C209.24,812.6467 149,769.9533 192.6667,720.3533 C240.76,665.7267 309.5,633.36 379.8,614.4933 " fill="transparent" id="Client-RS" style="stroke:#181818;stroke-width:0.6667;"></path><text fill="#000000" font-family="sans-serif" font-size="8.6667" lengthAdjust="spacing" textLength="166.4955" x="193.3333" y="618.2847">sends request to/receives response from</text><text fill="#000000" font-family="sans-serif" font-size="8.6667" lengthAdjust="spacing" textLength="4.9573" x="139.2533" y="908.1603">1</text><text fill="#000000" font-family="sans-serif" font-size="8.6667" lengthAdjust="spacing" textLength="4.9573" x="370.1357" y="624.2262">1</text></g><!--link GMN48 to RS--><g id="link_GMN48_RS"><path d="M637.8733,412.96 C562.9733,391.96 369.1667,350.8267 276.3333,454.6867 C223.3733,513.9467 288.5133,547.82 379.9533,567.1867 " fill="transparent" id="GMN48-RS" style="stroke:#181818;stroke-width:0.6667;stroke-dasharray:7.0,7.0;"></path></g><!--link GMN51 to ContentHashGenerator--><g id="link_GMN51_ContentHashGenerator"><path d="M599.5933,459.3 C498.6533,453.5667 317.7733,450.3267 276.3333,496.6867 C199.92,582.1867 207.3867,663.0667 276.3333,754.6867 C345.8533,847.08 486.12,867.5867 578.6267,870.32 " fill="transparent" id="GMN51-ContentHashGenerator" style="stroke:#181818;stroke-width:0.6667;stroke-dasharray:7.0,7.0;"></path></g><!--link GMN54 to ContentHashKeyRNDGenerator--><g id="link_GMN54_ContentHashKeyRNDGenerator"><path d="M1213.3067,326.3333 C1158.1667,317.1933 1064.16,311.7933 1017.6667,368.02 C946.0133,454.68 946.9533,786.6 1017.6667,874.02 C1054.9067,920.06 1122.6133,931.0333 1176.42,931.5067 " fill="transparent" id="GMN54-ContentHashKeyRNDGenerator" style="stroke:#181818;stroke-width:0.6667;stroke-dasharray:7.0,7.0;"></path></g><!--link GMN57 to ContentEncryption--><g id="link_GMN57_ContentEncryption"><path d="M580.48,500.2933 C477.3133,495.3533 315.2667,495.1267 276.3333,538.6867 C164.7733,663.5067 171.0333,785.2133 276.3333,915.3533 C349.4333,1005.7 493.9733,1013.78 585.6467,1008.4733 " fill="transparent" id="GMN57-ContentEncryption" style="stroke:#181818;stroke-width:0.6667;stroke-dasharray:7.0,7.0;"></path></g><!--link GMN60 to ContentEncKeyRNDGenerator--><g id="link_GMN60_ContentEncKeyRNDGenerator"><path d="M1213.3067,284.3333 C1158.1667,275.1933 1064.16,269.7933 1017.6667,326.02 C952.9067,404.3467 955.7533,702.76 1017.6667,783.3533 C1055.0267,831.9867 1125.12,846.1533 1179.72,849.1867 " fill="transparent" id="GMN60-ContentEncKeyRNDGenerator" style="stroke:#181818;stroke-width:0.6667;stroke-dasharray:7.0,7.0;"></path></g><!--link GMN63 to ContentIV_RNDGenerator--><g id="link_GMN63_ContentIV_RNDGenerator"><path d="M1188.18,369.82 C1132.96,367.66 1057.9467,375.1733 1017.6667,424.02 C943.02,514.5533 943.8733,860.8 1017.6667,952.02 C1057.9067,1001.7667 1133.7067,1010.5733 1189.1267,1009.4267 " fill="transparent" id="GMN63-ContentIV_RNDGenerator" style="stroke:#181818;stroke-width:0.6667;stroke-dasharray:7.0,7.0;"></path></g><!--link GMN66 to HKDF--><g id="link_GMN66_HKDF"><path d="M1653.3267,284.3533 C1601.22,277.2667 1519.6667,275.9333 1478.3333,326.02 C1461.1733,346.82 1463.0133,364.5 1478.3333,386.6867 C1498.9467,416.54 1531.5867,435.8333 1565.5933,448.3 " fill="transparent" id="GMN66-HKDF" style="stroke:#181818;stroke-width:0.6667;stroke-dasharray:7.0,7.0;"></path></g><!--link GMN69 to ContentEncKeyEncryption--><g id="link_GMN69_ContentEncKeyEncryption"><path d="M1213.3067,242.3333 C1158.1667,233.1933 1064.16,227.7933 1017.6667,284.02 C954.5467,360.36 1041.2467,450.2267 1127.2933,513.3067 " fill="transparent" id="GMN69-ContentEncKeyEncryption" style="stroke:#181818;stroke-width:0.6667;stroke-dasharray:7.0,7.0;"></path></g><!--link GMN72 to ContentNonceRNDGenerator--><g id="link_GMN72_ContentNonceRNDGenerator"><path d="M1653.3267,326.3533 C1601.22,319.2667 1519.6667,317.9333 1478.3333,368.02 C1435.7133,419.6733 1436.6,466.32 1478.3333,518.6867 C1510.96,559.6267 1569.14,571.9067 1617.8467,574.2 " fill="transparent" id="GMN72-ContentNonceRNDGenerator" style="stroke:#181818;stroke-width:0.6667;stroke-dasharray:7.0,7.0;"></path></g><!--link GMN75 to IdentityNonceRNDGenerator--><g id="link_GMN75_IdentityNonceRNDGenerator"><path d="M1624.8733,371.2 C1574.96,371.5533 1512.78,381.6733 1478.3333,424.02 C1429.9133,483.56 1430.5067,536.6733 1478.3333,596.6867 C1506.7533,632.36 1554.5733,646.2733 1598.6333,650.78 " fill="transparent" id="GMN75-IdentityNonceRNDGenerator" style="stroke:#181818;stroke-width:0.6667;stroke-dasharray:7.0,7.0;"></path></g><!--SRC=[jLTDRziu4BthLmpIYxseupR5zc1q0wYocmY5syBE-h9OB1HfR1EHHIr91PiM_UyTqfBrHTfkjptP8eTlPjuC7qaPHod2rVYLb-9QWU8Ws6Qh8642OyLuvia7bkMHY7OGfv6KlbA2tHSAmvXdI_OPuKNNv6qKFsm4Bx8au2aNy6mscxsT1fvdPY586MOAldW0en4Sy2HzxOS-vYWYxRiSOXbJB58uosBnbEk9mT3xMi4jbYweNIGLYlVuD85vzHS6Tv_cS7NvOcZtXNiV0SyK1KaUQSqWRduzXqAY29Fdm18QPEhf0yzYh3zzVpgSm9VMee3bMnGA_rErNRXghRcBDbyfW0HF1T34EX5AnqNN7uNPyaFk7wEK9SIrNwWj5-opuMOGnJ5AUSSVCACrVsgdKrs1d2eTRH0kofe6V9VpZFx92tYMwaQwJmiqzIbhltTt6ydj3MQQUkeFFMqj842KRYWAjTrDmA_-mXzmE_U3qVBM7rtz_jhOnJMkgVVzayA__gvmkqK6sEoTOoEUGPv6BDEq3XlhAKbBxEHZyM5goS3jIPVnE73TtZ_0Y3zRQZ96mTsYISY-hYq-ofbmTPgbzcQm4zJjs45yQC-JwVuI6iFLFzyB6guwcCtM9dqvsTQtxwVlVgIDQPcPjocLE-m41Nl4iDpAfKHq560l39HLs-n89NvA-zq4SsF6MbujKK13erhTr52einkq9v5dwM-jkOSUFggr9xMpqL27t0RjlT8rCDKwqT36vl-qD8p7y8wMLKuXNBKTjQBvNa-T57hEp7orgyfpOZJwpNuKJ7JZIeTPLowSnerMFcPpDbvNKaf3ZwH1MvdTNuwLGwwTPRNgqzusSvUd2iJA9LNDJPxNfwgsxtDprBn3Z-TAdbOOnJioxsBas1edFPubwilBwyf9lRU9npTlUA7oGbrV7nfRscdL264j1NDK4LsOeZQ65f5AEHLtHj-8fgitTjnUR5R8Mdv-1ifUxyv4iktJHfRbz9bWtNtN03gTMhMFBrvUw2xHFxIV9Y0nIoG8_BT0gHyyOthe89sdUapICIyHreBlF2_Z2ca-1xwktYmJM61EPleg06gBrRYVvocBZJx2WgVOMckyTjOjKF92n0XB58yeO42a29PjO4JcL-F5yjMm3-HGp9igPTZIZ3RK7ifZp0NGrxuQHaHPmdVmGA-bDKsLI0QTGhGXjXIk_910CDN1AWyeXqka0-UCm4fZQ7ZL1x05ho_SJZ0w4vi0fQPFpLMhFY4xFasdb5SsC6_3Ws6crSXGe9zBGEybPxvszknPak3hDd74O_DXEpLwBEoZNNSk2KsqOuTG3wxDWlSD]--></g></svg></p><div style="break-after:page"></div>
<p><strong>Class Diagram for Decryption Process:</strong></p>
<p class="plantuml"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentstyletype="text/css" data-diagram-type="CLASS" height="907.3333px" preserveAspectRatio="none" style="width:1771px;height:907px;background:#FFFFFF;" version="1.1" viewBox="0 0 1771 907" width="1771.3333px" zoomAndPan="magnify"><defs></defs><g><!--cluster Client Components--><g id="cluster_Client Components"><path d="M569.6667,494.7667 L659.1397,494.7667 A2.5,2.5 0 0 1 660.8063,496.4333 L665.473,511.4786 L1374.6667,511.4786 A1.6667,1.6667 0 0 1 1376.3333,513.1453 L1376.3333,769.1 A1.6667,1.6667 0 0 1 1374.6667,770.7667 L569.6667,770.7667 A1.6667,1.6667 0 0 1 568,769.1 L568,496.4333 A1.6667,1.6667 0 0 1 569.6667,494.7667 " fill="#ADD8E6" style="stroke:#000000;stroke-width:1;"></path><line style="stroke:#000000;stroke-width:1;" x1="568" x2="665.473" y1="511.4786" y2="511.4786"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" font-weight="bold" lengthAdjust="spacing" textLength="88.8063" x="570.6667" y="506.0773">Client Components</text></g><!--cluster RS Components--><g id="cluster_RS Components"><path d="M1069.6667,218.1 L1143.1051,218.1 A2.5,2.5 0 0 1 1144.7717,219.7667 L1149.4384,234.8119 L1749.3333,234.8119 A1.6667,1.6667 0 0 1 1751,236.4786 L1751,477.1 A1.6667,1.6667 0 0 1 1749.3333,478.7667 L1069.6667,478.7667 A1.6667,1.6667 0 0 1 1068,477.1 L1068,219.7667 A1.6667,1.6667 0 0 1 1069.6667,218.1 " fill="#ADD8E6" style="stroke:#000000;stroke-width:1;"></path><line style="stroke:#000000;stroke-width:1;" x1="1068" x2="1149.4384" y1="234.8119" y2="234.8119"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" font-weight="bold" lengthAdjust="spacing" textLength="72.7717" x="1070.6667" y="229.4106">RS Components</text></g><!--class ContentHashGenerator--><g id="elem_ContentHashGenerator"><rect codeline="23" fill="#EEEBDC" height="95.5597" id="ContentHashGenerator" rx="1.6667" ry="1.6667" style="stroke:#181818;stroke-width:0.3333;" width="179.5367" x="578.6667" y="664.4333"></rect><ellipse cx="614.3385" cy="675.1" fill="#ADD1B2" rx="7.3333" ry="7.3333" style="stroke:#181818;stroke-width:0.6667;"></ellipse><path d="M616.3177,678.8604 Q615.9323,679.0583 615.5052,679.1521 Q615.0781,679.2563 614.6094,679.2563 Q612.9427,679.2563 612.0573,678.1625 Q611.1823,677.0583 611.1823,674.975 Q611.1823,672.8917 612.0573,671.7875 Q612.9427,670.6833 614.6094,670.6833 Q615.0781,670.6833 615.5052,670.7875 Q615.9427,670.8917 616.3177,671.0896 L616.3177,672.9021 Q615.901,672.5167 615.5052,672.3396 Q615.1094,672.1521 614.6927,672.1521 Q613.7969,672.1521 613.3385,672.8708 Q612.8802,673.5792 612.8802,674.975 Q612.8802,676.3708 613.3385,677.0896 Q613.7969,677.7979 614.6927,677.7979 Q615.1094,677.7979 615.5052,677.6208 Q615.901,677.4333 616.3177,677.0479 L616.3177,678.8604 Z " fill="#000000"></path><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="102.5263" x="628.0052" y="678.7213">ContentHashGenerator</text><line style="stroke:#181818;stroke-width:0.3333;" x1="579.3333" x2="757.5367" y1="685.7667" y2="685.7667"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="169.4367" x="582.6667" y="713.7892">algorithm: Algorithm = HMAC-SHA-256</text><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="102.0596" x="582.6667" y="726.5012">contentHashKey: byte[]</text><line style="stroke:#181818;stroke-width:0.6667;" x1="579.3333" x2="646.6464" y1="697.456" y2="697.456"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="43.5772" x="646.6464" y="700.744">Attributes</text><line style="stroke:#181818;stroke-width:0.6667;" x1="690.2236" x2="757.5367" y1="697.456" y2="697.456"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="171.5367" x="582.6667" y="754.5917">generateContentHash(plaintext): byte[]</text><line style="stroke:#181818;stroke-width:0.6667;" x1="579.3333" x2="643.9118" y1="738.2585" y2="738.2585"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="49.0465" x="643.9118" y="741.5465">Operations</text><line style="stroke:#181818;stroke-width:0.6667;" x1="692.9583" x2="757.5367" y1="738.2585" y2="738.2585"></line></g><!--class ContentIntegrityVerification--><g id="elem_ContentIntegrityVerification"><rect codeline="31" fill="#EEEBDC" height="54.7572" id="ContentIntegrityVerification" rx="1.6667" ry="1.6667" style="stroke:#181818;stroke-width:0.3333;" width="250.7404" x="1115" y="694.1"></rect><ellipse cx="1176.3198" cy="704.7667" fill="#ADD1B2" rx="7.3333" ry="7.3333" style="stroke:#181818;stroke-width:0.6667;"></ellipse><path d="M1178.299,708.5271 Q1177.9135,708.725 1177.4865,708.8188 Q1177.0594,708.9229 1176.5906,708.9229 Q1174.924,708.9229 1174.0385,707.8292 Q1173.1635,706.725 1173.1635,704.6417 Q1173.1635,702.5583 1174.0385,701.4542 Q1174.924,700.35 1176.5906,700.35 Q1177.0594,700.35 1177.4865,700.4542 Q1177.924,700.5583 1178.299,700.7563 L1178.299,702.5688 Q1177.8823,702.1833 1177.4865,702.0063 Q1177.0906,701.8188 1176.674,701.8188 Q1175.7781,701.8188 1175.3198,702.5375 Q1174.8615,703.2458 1174.8615,704.6417 Q1174.8615,706.0375 1175.3198,706.7563 Q1175.7781,707.4646 1176.674,707.4646 Q1177.0906,707.4646 1177.4865,707.2875 Q1177.8823,707.1 1178.299,706.7146 L1178.299,708.5271 Z " fill="#000000"></path><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="122.4342" x="1189.9865" y="708.388">ContentIntegrityVerification</text><line style="stroke:#181818;stroke-width:0.3333;" x1="1115.6667" x2="1365.0738" y1="715.4333" y2="715.4333"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="242.7404" x="1119" y="743.4559">verifyContentIntegrity(plaintext, contentHash): boolean</text><line style="stroke:#181818;stroke-width:0.6667;" x1="1115.6667" x2="1215.847" y1="727.1226" y2="727.1226"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="49.0465" x="1215.847" y="730.4106">Operations</text><line style="stroke:#181818;stroke-width:0.6667;" x1="1264.8935" x2="1365.0738" y1="727.1226" y2="727.1226"></line></g><!--class ContentDecryption--><g id="elem_ContentDecryption"><rect codeline="36" fill="#EEEBDC" height="120.9836" id="ContentDecryption" rx="1.6667" ry="1.6667" style="stroke:#181818;stroke-width:0.3333;" width="165.3594" x="585.6667" y="520.4333"></rect><ellipse cx="623.9192" cy="531.1" fill="#ADD1B2" rx="7.3333" ry="7.3333" style="stroke:#181818;stroke-width:0.6667;"></ellipse><path d="M625.8984,534.8604 Q625.5129,535.0583 625.0859,535.1521 Q624.6588,535.2563 624.19,535.2563 Q622.5234,535.2563 621.6379,534.1625 Q620.7629,533.0583 620.7629,530.975 Q620.7629,528.8917 621.6379,527.7875 Q622.5234,526.6833 624.19,526.6833 Q624.6588,526.6833 625.0859,526.7875 Q625.5234,526.8917 625.8984,527.0896 L625.8984,528.9021 Q625.4817,528.5167 625.0859,528.3396 Q624.69,528.1521 624.2734,528.1521 Q623.3775,528.1521 622.9192,528.8708 Q622.4609,529.5792 622.4609,530.975 Q622.4609,532.3708 622.9192,533.0896 Q623.3775,533.7979 624.2734,533.7979 Q624.69,533.7979 625.0859,533.6208 Q625.4817,533.4333 625.8984,533.0479 L625.8984,534.8604 Z " fill="#000000"></path><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="83.1877" x="637.5859" y="534.7213">ContentDecryption</text><line style="stroke:#181818;stroke-width:0.3333;" x1="586.3333" x2="750.3594" y1="541.7667" y2="541.7667"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="157.3594" x="589.6667" y="569.7892">algorithm: Algorithm = AES-256-CTR</text><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="95.1063" x="589.6667" y="582.5012">contentEncKey: byte[]</text><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="72.6317" x="589.6667" y="595.2131">contentIV: byte[]</text><line style="stroke:#181818;stroke-width:0.6667;" x1="586.3333" x2="646.5578" y1="553.456" y2="553.456"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="43.5772" x="646.5578" y="556.744">Attributes</text><line style="stroke:#181818;stroke-width:0.6667;" x1="690.1349" x2="750.3594" y1="553.456" y2="553.456"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="142.6221" x="589.6667" y="623.3037">encryptContent(plaintext): byte[]</text><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="148.5488" x="589.6667" y="636.0156">decryptContent(ciphertext): byte[]</text><line style="stroke:#181818;stroke-width:0.6667;" x1="586.3333" x2="643.8231" y1="606.9704" y2="606.9704"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="49.0465" x="643.8231" y="610.2584">Operations</text><line style="stroke:#181818;stroke-width:0.6667;" x1="692.8696" x2="750.3594" y1="606.9704" y2="606.9704"></line></g><!--class ContentEncKeyDecryption--><g id="elem_ContentEncKeyDecryption"><rect codeline="48" fill="#EEEBDC" height="146.4075" id="ContentEncKeyDecryption" rx="1.6667" ry="1.6667" style="stroke:#181818;stroke-width:0.3333;" width="323.2602" x="1078.6667" y="321.4333"></rect><ellipse cx="1180.2503" cy="332.1" fill="#ADD1B2" rx="7.3333" ry="7.3333" style="stroke:#181818;stroke-width:0.6667;"></ellipse><path d="M1182.2295,335.8604 Q1181.8441,336.0583 1181.417,336.1521 Q1180.9899,336.2562 1180.5211,336.2562 Q1178.8545,336.2562 1177.9691,335.1625 Q1177.0941,334.0583 1177.0941,331.975 Q1177.0941,329.8917 1177.9691,328.7875 Q1178.8545,327.6833 1180.5211,327.6833 Q1180.9899,327.6833 1181.417,327.7875 Q1181.8545,327.8917 1182.2295,328.0896 L1182.2295,329.9021 Q1181.8128,329.5167 1181.417,329.3396 Q1181.0211,329.1521 1180.6045,329.1521 Q1179.7086,329.1521 1179.2503,329.8708 Q1178.792,330.5792 1178.792,331.975 Q1178.792,333.3708 1179.2503,334.0896 Q1179.7086,334.7979 1180.6045,334.7979 Q1181.0211,334.7979 1181.417,334.6208 Q1181.8128,334.4333 1182.2295,334.0479 L1182.2295,335.8604 Z " fill="#000000"></path><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="114.4262" x="1193.917" y="335.7213">ContentEncKeyDecryption</text><line style="stroke:#181818;stroke-width:0.3333;" x1="1079.3333" x2="1401.2602" y1="342.7667" y2="342.7667"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="161.6247" x="1082.6667" y="370.7892">algorithm: Algorithm = AES-256-GCM</text><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="134.3341" x="1082.6667" y="383.5012">identityEncKey: IdentityEncKey</text><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="72.0531" x="1082.6667" y="396.2131">identityIV: byte[]</text><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="82.0304" x="1082.6667" y="408.9251">identityAAD: byte[]</text><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="98.1956" x="1082.6667" y="421.637">identityAADTag: byte[]</text><line style="stroke:#181818;stroke-width:0.6667;" x1="1079.3333" x2="1218.5082" y1="354.456" y2="354.456"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="43.5772" x="1218.5082" y="357.744">Attributes</text><line style="stroke:#181818;stroke-width:0.6667;" x1="1262.0853" x2="1401.2602" y1="354.456" y2="354.456"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="315.2602" x="1082.6667" y="449.7276">encryptKey(contentEncKey): {contentEncKeyCiphertext, identityAADTag}</text><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="309.5575" x="1082.6667" y="462.4395">decryptKey(contentEncKeyCiphertext, identityAADTag): ContentEncKey</text><line style="stroke:#181818;stroke-width:0.6667;" x1="1079.3333" x2="1215.7735" y1="433.3943" y2="433.3943"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="49.0465" x="1215.7735" y="436.6823">Operations</text><line style="stroke:#181818;stroke-width:0.6667;" x1="1264.82" x2="1401.2602" y1="433.3943" y2="433.3943"></line></g><!--class HKDF--><g id="elem_HKDF"><rect codeline="60" fill="#EEEBDC" height="95.5597" id="HKDF" rx="1.6667" ry="1.6667" style="stroke:#181818;stroke-width:0.3333;" width="270.4896" x="1469.6667" y="243.7667"></rect><ellipse cx="1589.9029" cy="254.4333" fill="#ADD1B2" rx="7.3333" ry="7.3333" style="stroke:#181818;stroke-width:0.6667;"></ellipse><path d="M1591.882,258.1937 Q1591.4966,258.3917 1591.0695,258.4854 Q1590.6424,258.5896 1590.1737,258.5896 Q1588.507,258.5896 1587.6216,257.4958 Q1586.7466,256.3917 1586.7466,254.3083 Q1586.7466,252.225 1587.6216,251.1208 Q1588.507,250.0167 1590.1737,250.0167 Q1590.6424,250.0167 1591.0695,250.1208 Q1591.507,250.225 1591.882,250.4229 L1591.882,252.2354 Q1591.4654,251.85 1591.0695,251.6729 Q1590.6737,251.4854 1590.257,251.4854 Q1589.3612,251.4854 1588.9029,252.2042 Q1588.4445,252.9125 1588.4445,254.3083 Q1588.4445,255.7042 1588.9029,256.4229 Q1589.3612,257.1312 1590.257,257.1312 Q1590.6737,257.1312 1591.0695,256.9542 Q1591.4654,256.7667 1591.882,256.3812 L1591.882,258.1937 Z " fill="#000000"></path><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="24.3506" x="1603.5695" y="258.0547">HKDF</text><line style="stroke:#181818;stroke-width:0.3333;" x1="1470.3333" x2="1739.4896" y1="265.1" y2="265.1"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="126.5129" x="1473.6667" y="293.1226">algorithm: Algorithm = HKDF</text><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="98.1116" x="1473.6667" y="305.8345">masterKey: MasterKey</text><line style="stroke:#181818;stroke-width:0.6667;" x1="1470.3333" x2="1583.1229" y1="276.7893" y2="276.7893"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="43.5772" x="1583.1229" y="280.0773">Attributes</text><line style="stroke:#181818;stroke-width:0.6667;" x1="1626.7001" x2="1739.4896" y1="276.7893" y2="276.7893"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="262.4896" x="1473.6667" y="333.9251">deriveIdentityEncKey(identityNonce, userId): IdentityEncKey</text><line style="stroke:#181818;stroke-width:0.6667;" x1="1470.3333" x2="1580.3882" y1="317.5918" y2="317.5918"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="49.0465" x="1580.3882" y="320.8798">Operations</text><line style="stroke:#181818;stroke-width:0.6667;" x1="1629.4347" x2="1739.4896" y1="317.5918" y2="317.5918"></line></g><!--class AuthorizationAssessment--><g id="elem_AuthorizationAssessment"><rect codeline="68" fill="#EEEBDC" height="54.7572" id="AuthorizationAssessment" rx="1.6667" ry="1.6667" style="stroke:#181818;stroke-width:0.3333;" width="181.5527" x="1149.6667" y="243.4333"></rect><ellipse cx="1181.6939" cy="254.1" fill="#ADD1B2" rx="7.3333" ry="7.3333" style="stroke:#181818;stroke-width:0.6667;"></ellipse><path d="M1183.673,257.8604 Q1183.2876,258.0583 1182.8605,258.1521 Q1182.4335,258.2562 1181.9647,258.2562 Q1180.298,258.2562 1179.4126,257.1625 Q1178.5376,256.0583 1178.5376,253.975 Q1178.5376,251.8917 1179.4126,250.7875 Q1180.298,249.6833 1181.9647,249.6833 Q1182.4335,249.6833 1182.8605,249.7875 Q1183.298,249.8917 1183.673,250.0896 L1183.673,251.9021 Q1183.2564,251.5167 1182.8605,251.3396 Q1182.4647,251.1521 1182.048,251.1521 Q1181.1522,251.1521 1180.6939,251.8708 Q1180.2355,252.5792 1180.2355,253.975 Q1180.2355,255.3708 1180.6939,256.0896 Q1181.1522,256.7979 1182.048,256.7979 Q1182.4647,256.7979 1182.8605,256.6208 Q1183.2564,256.4333 1183.673,256.0479 L1183.673,257.8604 Z " fill="#000000"></path><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="111.8316" x="1195.3605" y="257.7213">AuthorizationAssessment</text><line style="stroke:#181818;stroke-width:0.3333;" x1="1150.3333" x2="1330.5527" y1="264.7667" y2="264.7667"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="173.5527" x="1153.6667" y="292.7892">authorizeRequest(accessToken): UserID</text><line style="stroke:#181818;stroke-width:0.6667;" x1="1150.3333" x2="1215.9197" y1="276.456" y2="276.456"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="49.0465" x="1215.9197" y="279.744">Operations</text><line style="stroke:#181818;stroke-width:0.6667;" x1="1264.9662" x2="1330.5527" y1="276.456" y2="276.456"></line></g><!--class Client--><g id="elem_Client"><rect codeline="6" fill="#EEEBDC" height="82.8478" id="Client" rx="1.6667" ry="1.6667" style="stroke:#181818;stroke-width:0.3333;" width="124.1622" x="26.3333" y="628.7667"></rect><ellipse cx="73.0232" cy="639.4333" fill="#ADD1B2" rx="7.3333" ry="7.3333" style="stroke:#181818;stroke-width:0.6667;"></ellipse><path d="M75.0023,643.1938 Q74.6169,643.3917 74.1898,643.4854 Q73.7627,643.5896 73.294,643.5896 Q71.6273,643.5896 70.7419,642.4958 Q69.8669,641.3917 69.8669,639.3083 Q69.8669,637.225 70.7419,636.1208 Q71.6273,635.0167 73.294,635.0167 Q73.7627,635.0167 74.1898,635.1208 Q74.6273,635.225 75.0023,635.4229 L75.0023,637.2354 Q74.5857,636.85 74.1898,636.6729 Q73.794,636.4854 73.3773,636.4854 Q72.4815,636.4854 72.0232,637.2042 Q71.5648,637.9125 71.5648,639.3083 Q71.5648,640.7042 72.0232,641.4229 Q72.4815,642.1313 73.3773,642.1313 Q73.794,642.1313 74.1898,641.9542 Q74.5857,641.7667 75.0023,641.3813 L75.0023,643.1938 Z " fill="#000000"></path><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="25.1159" x="86.6898" y="643.0547">Client</text><line style="stroke:#181818;stroke-width:0.3333;" x1="27" x2="149.8289" y1="650.1" y2="650.1"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="116.1622" x="30.3333" y="678.1226">accessToken: AccessToken</text><line style="stroke:#181818;stroke-width:0.6667;" x1="27" x2="66.6258" y1="661.7893" y2="661.7893"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="43.5772" x="66.6258" y="665.0773">Attributes</text><line style="stroke:#181818;stroke-width:0.6667;" x1="110.203" x2="149.8289" y1="661.7893" y2="661.7893"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="83.9343" x="30.3333" y="706.2131">initiateDecryption()</text><line style="stroke:#181818;stroke-width:0.6667;" x1="27" x2="63.8912" y1="689.8799" y2="689.8799"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="49.0465" x="63.8912" y="693.1678">Operations</text><line style="stroke:#181818;stroke-width:0.6667;" x1="112.9377" x2="149.8289" y1="689.8799" y2="689.8799"></line></g><!--class RS--><g id="elem_RS"><rect codeline="13" fill="#EEEBDC" height="108.2717" id="RS" rx="1.6667" ry="1.6667" style="stroke:#181818;stroke-width:0.3333;" width="576.7712" x="380" y="366.7667"></rect><ellipse cx="660.0876" cy="377.4333" fill="#ADD1B2" rx="7.3333" ry="7.3333" style="stroke:#181818;stroke-width:0.6667;"></ellipse><path d="M662.0668,381.1937 Q661.6814,381.3917 661.2543,381.4854 Q660.8272,381.5896 660.3585,381.5896 Q658.6918,381.5896 657.8064,380.4958 Q656.9314,379.3917 656.9314,377.3083 Q656.9314,375.225 657.8064,374.1208 Q658.6918,373.0167 660.3585,373.0167 Q660.8272,373.0167 661.2543,373.1208 Q661.6918,373.225 662.0668,373.4229 L662.0668,375.2354 Q661.6501,374.85 661.2543,374.6729 Q660.8585,374.4854 660.4418,374.4854 Q659.546,374.4854 659.0876,375.2042 Q658.6293,375.9125 658.6293,377.3083 Q658.6293,378.7042 659.0876,379.4229 Q659.546,380.1312 660.4418,380.1312 Q660.8585,380.1312 661.2543,379.9542 Q661.6501,379.7667 662.0668,379.3812 L662.0668,381.1937 Z " fill="#000000"></path><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="10.9293" x="673.7543" y="381.0547">RS</text><line style="stroke:#181818;stroke-width:0.3333;" x1="380.6667" x2="956.1046" y1="388.1" y2="388.1"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="141.0448" x="384" y="416.1226">masterKey: MasterKey (TPM 2.0)</text><line style="stroke:#181818;stroke-width:0.6667;" x1="380.6667" x2="646.597" y1="399.7893" y2="399.7893"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="43.5772" x="646.597" y="403.0773">Attributes</text><line style="stroke:#181818;stroke-width:0.6667;" x1="690.1742" x2="956.1046" y1="399.7893" y2="399.7893"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="568.7712" x="384" y="444.2131">encryptContentEncKey(contentEncKey, userId, identityNonce, identityAAD): {contentEncKeyCiphertext, identityIV, identityAADTag}</text><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="563.0686" x="384" y="456.9251">decryptContentEncKey(contentEncKeyCiphertext, userId, identityNonce, identityIV, identityAAD, identityAADTag): ContentEncKey</text><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="190.1659" x="384" y="469.637">validateAuthorization(accessToken): UserID</text><line style="stroke:#181818;stroke-width:0.6667;" x1="380.6667" x2="643.8624" y1="427.8799" y2="427.8799"></line><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="49.0465" x="643.8624" y="431.1678">Operations</text><line style="stroke:#181818;stroke-width:0.6667;" x1="692.9089" x2="956.1046" y1="427.8799" y2="427.8799"></line></g><!--class ContentPlaintext--><g id="elem_ContentPlaintext"><rect fill="#EEEBDC" height="32" id="ContentPlaintext" rx="1.6667" ry="1.6667" style="stroke:#181818;stroke-width:0.3333;" width="94.8237" x="1193" y="781.4333"></rect><ellipse cx="1203" cy="792.1" fill="#ADD1B2" rx="7.3333" ry="7.3333" style="stroke:#181818;stroke-width:0.6667;"></ellipse><path d="M1204.9792,795.8604 Q1204.5938,796.0583 1204.1667,796.1521 Q1203.7396,796.2563 1203.2708,796.2563 Q1201.6042,796.2563 1200.7188,795.1625 Q1199.8438,794.0583 1199.8438,791.975 Q1199.8438,789.8917 1200.7188,788.7875 Q1201.6042,787.6833 1203.2708,787.6833 Q1203.7396,787.6833 1204.1667,787.7875 Q1204.6042,787.8917 1204.9792,788.0896 L1204.9792,789.9021 Q1204.5625,789.5167 1204.1667,789.3396 Q1203.7708,789.1521 1203.3542,789.1521 Q1202.4583,789.1521 1202,789.8708 Q1201.5417,790.5792 1201.5417,791.975 Q1201.5417,793.3708 1202,794.0896 Q1202.4583,794.7979 1203.3542,794.7979 Q1203.7708,794.7979 1204.1667,794.6208 Q1204.5625,794.4333 1204.9792,794.0479 L1204.9792,795.8604 Z " fill="#000000"></path><text fill="#000000" font-family="sans-serif" font-size="9.3333" lengthAdjust="spacing" textLength="73.4904" x="1212.3333" y="795.7213">ContentPlaintext</text><line style="stroke:#181818;stroke-width:0.3333;" x1="1193.6667" x2="1287.1571" y1="802.7667" y2="802.7667"></line><line style="stroke:#181818;stroke-width:0.3333;" x1="1193.6667" x2="1287.1571" y1="808.1" y2="808.1"></line></g><g id="elem_GMN27"><path d="M4,586.7667 L4,605.2373 A0,0 0 0 0 4,605.2373 L85.6667,605.2373 L88.3333,628.7667 L91,605.2373 L172.8735,605.2373 A0,0 0 0 0 172.8735,605.2373 L172.8735,593.4333 L166.2068,586.7667 L4,586.7667 A0,0 0 0 0 4,586.7667 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.3333;"></path><path d="M166.2068,586.7667 L166.2068,593.4333 L172.8735,593.4333 L166.2068,586.7667 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.3333;"></path><text fill="#000000" font-family="sans-serif" font-size="8.6667" lengthAdjust="spacing" textLength="154.8735" x="8" y="599.3647">Represents the Client Application Role</text></g><g id="elem_GMN30"><path d="M546.6667,240.7667 L546.6667,259.2373 L789.6749,259.2373 L789.6749,247.4333 L783.0082,240.7667 L546.6667,240.7667 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.3333;"></path><path d="M783.0082,240.7667 L783.0082,247.4333 L789.6749,247.4333 L783.0082,240.7667 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.6667;"></path><text fill="#000000" font-family="sans-serif" font-size="8.6667" lengthAdjust="spacing" textLength="229.0082" x="550.6667" y="253.3647">Represents the Resource Server (Keyring - RS2/RS3) Role</text></g><g id="elem_GMN33"><path d="M599.6667,324.7667 L599.6667,343.2373 L737.3141,343.2373 L737.3141,331.4333 L730.6474,324.7667 L599.6667,324.7667 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.3333;"></path><path d="M730.6474,324.7667 L730.6474,331.4333 L737.3141,331.4333 L730.6474,324.7667 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.6667;"></path><text fill="#000000" font-family="sans-serif" font-size="8.6667" lengthAdjust="spacing" textLength="123.6474" x="603.6667" y="337.3647">Generates hash of the content</text></g><g id="elem_GMN36"><path d="M1148.6667,188.7667 L1148.6667,207.2373 L1332.3082,207.2373 L1332.3082,195.4333 L1325.6415,188.7667 L1148.6667,188.7667 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.3333;"></path><path d="M1325.6415,188.7667 L1325.6415,195.4333 L1332.3082,195.4333 L1325.6415,188.7667 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.6667;"></path><text fill="#000000" font-family="sans-serif" font-size="8.6667" lengthAdjust="spacing" textLength="169.6415" x="1152.6667" y="201.3647">Verifies the integrity of decrypted content</text></g><g id="elem_GMN39"><path d="M604.6667,282.7667 L604.6667,301.2373 L731.6974,301.2373 L731.6974,289.4333 L725.0308,282.7667 L604.6667,282.7667 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.3333;"></path><path d="M725.0308,282.7667 L725.0308,289.4333 L731.6974,289.4333 L725.0308,282.7667 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.6667;"></path><text fill="#000000" font-family="sans-serif" font-size="8.6667" lengthAdjust="spacing" textLength="113.0308" x="608.6667" y="295.3647">Decrypts content ciphertext</text></g><g id="elem_GMN42"><path d="M1144.6667,146.7667 L1144.6667,165.2373 L1335.8222,165.2373 L1335.8222,153.4333 L1329.1555,146.7667 L1144.6667,146.7667 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.3333;"></path><path d="M1329.1555,146.7667 L1329.1555,153.4333 L1335.8222,153.4333 L1329.1555,146.7667 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.6667;"></path><text fill="#000000" font-family="sans-serif" font-size="8.6667" lengthAdjust="spacing" textLength="177.1555" x="1148.6667" y="159.3647">Decrypts Content Encryption Key ciphertext</text></g><g id="elem_GMN45"><path d="M1442.6667,188.7667 L1442.6667,207.2373 A0,0 0 0 0 1442.6667,207.2373 L1602.3333,207.2373 L1605,243.6733 L1607.6667,207.2373 L1767.2195,207.2373 A0,0 0 0 0 1767.2195,207.2373 L1767.2195,195.4333 L1760.5528,188.7667 L1442.6667,188.7667 A0,0 0 0 0 1442.6667,188.7667 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.3333;"></path><path d="M1760.5528,188.7667 L1760.5528,195.4333 L1767.2195,195.4333 L1760.5528,188.7667 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.3333;"></path><text fill="#000000" font-family="sans-serif" font-size="8.6667" lengthAdjust="spacing" textLength="310.5528" x="1446.6667" y="201.3647">Derives Identity Encryption Key from Master Key, Identity nonce and User ID</text></g><g id="elem_GMN48"><path d="M1096,104.7667 L1096,123.2373 L1384.4042,123.2373 L1384.4042,111.4333 L1377.7375,104.7667 L1096,104.7667 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.3333;"></path><path d="M1377.7375,104.7667 L1377.7375,111.4333 L1384.4042,111.4333 L1377.7375,104.7667 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.6667;"></path><text fill="#000000" font-family="sans-serif" font-size="8.6667" lengthAdjust="spacing" textLength="274.4042" x="1100" y="117.3647">Assesses authorization based on Access Token and extracts User ID</text></g><!--link Client to ContentHashGenerator--><g id="link_Client_ContentHashGenerator"><path codeline="74" d="M150.38,674.5533 C252.9867,682 451.7676,696.4343 570.4676,705.0477 " fill="transparent" id="Client-to-ContentHashGenerator" style="stroke:#181818;stroke-width:0.6667;"></path><polygon fill="#181818" points="578.4467,705.6267,574.6502,702.6775,570.4676,705.0477,574.2642,707.9968,578.4467,705.6267" style="stroke:#181818;stroke-width:0.6667;"></polygon><text fill="#000000" font-family="sans-serif" font-size="8.6667" lengthAdjust="spacing" textLength="18.5467" x="267.3333" y="676.0313">uses</text></g><!--link Client to ContentIntegrityVerification--><g id="link_Client_ContentIntegrityVerification"><path codeline="75" d="M150.5533,702.0467 C208.1133,729.9933 297.36,768.4933 380,784.1 C675.8333,839.98 784.8067,902.7133 1057.3333,774.7667 C1060.3667,773.34 1059.7667,771.1133 1062.6667,769.4333 C1078.78,760.1 1089.1934,755.0782 1107.3667,748.9448 " fill="transparent" id="Client-to-ContentIntegrityVerification" style="stroke:#181818;stroke-width:0.6667;"></path><polygon fill="#181818" points="1114.9467,746.3867,1110.304,745.1391,1107.3667,748.9448,1112.0094,750.1924,1114.9467,746.3867" style="stroke:#181818;stroke-width:0.6667;"></polygon><text fill="#000000" font-family="sans-serif" font-size="8.6667" lengthAdjust="spacing" textLength="18.5467" x="659.3333" y="781.3647">uses</text></g><!--link Client to ContentDecryption--><g id="link_Client_ContentDecryption"><path codeline="76" d="M150.38,660.6267 C255.0933,644.46 460.387,612.7674 577.747,594.6474 " fill="transparent" id="Client-to-ContentDecryption" style="stroke:#181818;stroke-width:0.6667;"></path><polygon fill="#181818" points="585.6533,593.4267,581.2933,591.4016,577.747,594.6474,582.1071,596.6725,585.6533,593.4267" style="stroke:#181818;stroke-width:0.6667;"></polygon><text fill="#000000" font-family="sans-serif" font-size="8.6667" lengthAdjust="spacing" textLength="18.5467" x="267.3333" y="628.698">uses</text></g><!--link RS to ContentEncKeyDecryption--><g id="link_RS_ContentEncKeyDecryption"><path codeline="78" d="M956.84,407.6533 C998.6667,405.7467 1032.435,404.2118 1070.5217,402.4718 " fill="transparent" id="RS-to-ContentEncKeyDecryption" style="stroke:#181818;stroke-width:0.6667;"></path><polygon fill="#181818" points="1078.5133,402.1067,1074.3958,399.6253,1070.5217,402.4718,1074.6392,404.9531,1078.5133,402.1067" style="stroke:#181818;stroke-width:0.6667;"></polygon><text fill="#000000" font-family="sans-serif" font-size="8.6667" lengthAdjust="spacing" textLength="18.5467" x="1008" y="400.698">uses</text></g><!--link RS to HKDF--><g id="link_RS_HKDF"><path codeline="79" d="M942.1533,366.7267 C947.1867,362.9867 952.0333,359 956.6667,354.7667 C977.8267,335.42 966.5667,320.2667 976.6667,293.4333 C1010.8533,202.6267 981.66,146.18 1062.6667,92.7667 C1188.5733,9.7467 1280.0733,4 1402,92.7667 C1449.5733,127.4 1403.4133,174.9267 1442.6667,218.7667 C1451.08,228.1667 1454.3387,231.9204 1464.972,239.1537 " fill="transparent" id="RS-to-HKDF" style="stroke:#181818;stroke-width:0.6667;"></path><polygon fill="#181818" points="1471.5867,243.6533,1469.7792,239.1986,1464.972,239.1537,1466.7795,243.6084,1471.5867,243.6533" style="stroke:#181818;stroke-width:0.6667;"></polygon><text fill="#000000" font-family="sans-serif" font-size="8.6667" lengthAdjust="spacing" textLength="18.5467" x="1231.3333" y="26.0313">uses</text></g><!--link RS to AuthorizationAssessment--><g id="link_RS_AuthorizationAssessment"><path codeline="80" d="M917.5,366.7133 C930.8133,362.9 943.94,358.9133 956.6667,354.7667 C1005.3867,338.9 1013.8667,325.0467 1062.6667,309.4333 C1090.5267,300.52 1113.6816,294.644 1141.835,288.6573 " fill="transparent" id="RS-to-AuthorizationAssessment" style="stroke:#181818;stroke-width:0.6667;"></path><polygon fill="#181818" points="1149.66,286.9933,1145.1928,285.217,1141.835,288.6573,1146.3021,290.4337,1149.66,286.9933" style="stroke:#181818;stroke-width:0.6667;"></polygon><text fill="#000000" font-family="sans-serif" font-size="8.6667" lengthAdjust="spacing" textLength="18.5467" x="1008" y="308.698">uses</text></g><!--link ContentDecryption to ContentEncKeyDecryption--><g id="link_ContentDecryption_ContentEncKeyDecryption"><path codeline="82" d="M751.0667,554.02 C836.2667,526.2467 971.7667,482.0867 1078.4867,447.3 " fill="transparent" id="ContentDecryption-ContentEncKeyDecryption" style="stroke:#181818;stroke-width:0.6667;"></path></g><!--link ContentEncKeyDecryption to ContentDecryption--><g id="link_ContentEncKeyDecryption_ContentDecryption"><path codeline="89" d="M1121.2733,468.1467 C1100.4733,479.0733 1078.6533,489.36 1057.3333,497.4333 C955.3733,536.06 835.1645,558.1807 755.1312,569.8941 " fill="transparent" id="ContentEncKeyDecryption-to-ContentDecryption" style="stroke:#181818;stroke-width:0.6667;stroke-dasharray:7.0,7.0;"></path><polygon fill="#181818" points="751.1733,570.4733,757.4963,572.243,754.4715,569.9906,756.7239,566.9659,751.1733,570.4733" style="stroke:#181818;stroke-width:0.6667;"></polygon><text fill="#000000" font-family="sans-serif" font-size="8.6667" lengthAdjust="spacing" textLength="73.7794" x="980.3333" y="494.698">output provides</text></g><!--link ContentIntegrityVerification to ContentHashGenerator--><g id="link_ContentIntegrityVerification_ContentHashGenerator"><path codeline="83" d="M1114.8733,726.0867 C1095.6067,726.6467 1075.94,727.1267 1057.3333,727.4333 C1021.4867,728.0267 1012.5067,728.3267 976.6667,727.4333 C903.02,725.6 819.5467,721.3 758.1467,717.72 " fill="transparent" id="ContentIntegrityVerification-ContentHashGenerator" style="stroke:#181818;stroke-width:0.6667;"></path></g><!--link ContentHashGenerator to ContentIntegrityVerification--><g id="link_ContentHashGenerator_ContentIntegrityVerification"><path codeline="88" d="M758.1667,713.56 C854.0133,715.1267 1003.0939,717.568 1110.8739,719.328 " fill="transparent" id="ContentHashGenerator-to-ContentIntegrityVerification" style="stroke:#181818;stroke-width:0.6667;stroke-dasharray:7.0,7.0;"></path><polygon fill="#181818" points="1114.8733,719.3933,1108.9177,716.6291,1111.5404,719.3389,1108.8306,721.9617,1114.8733,719.3933" style="stroke:#181818;stroke-width:0.6667;"></polygon><text fill="#000000" font-family="sans-serif" font-size="8.6667" lengthAdjust="spacing" textLength="73.7794" x="980.3333" y="714.698">output provides</text></g><!--link ContentEncKeyDecryption to HKDF--><g id="link_ContentEncKeyDecryption_HKDF"><path codeline="84" d="M1402.2133,348.92 C1424.6933,342.5267 1447.5867,336.0133 1469.5133,329.78 " fill="transparent" id="ContentEncKeyDecryption-HKDF" style="stroke:#181818;stroke-width:0.6667;"></path></g><!--link AuthorizationAssessment to HKDF--><g id="link_AuthorizationAssessment_HKDF"><path codeline="85" d="M1331.0467,275.8867 C1372.8133,278.2667 1423.3333,281.14 1469.52,283.7667 " fill="transparent" id="AuthorizationAssessment-HKDF" style="stroke:#181818;stroke-width:0.6667;"></path></g><!--link ContentDecryption to ContentPlaintext--><g id="link_ContentDecryption_ContentPlaintext"><path codeline="87" d="M751.12,579.4867 C815.62,583.0333 903.1933,598.6733 956.6667,652.7667 C983.6467,680.06 951.5333,707.7667 976.6667,736.7667 C1003.58,767.8267 1022.98,760.08 1062.6667,770.7667 C1106.0267,782.44 1152.8563,789.0057 1188.8829,792.8791 " fill="transparent" id="ContentDecryption-to-ContentPlaintext" style="stroke:#181818;stroke-width:0.6667;stroke-dasharray:7.0,7.0;"></path><polygon fill="#181818" points="1192.86,793.3067,1187.1794,790.0139,1189.5458,792.9503,1186.6093,795.3167,1192.86,793.3067" style="stroke:#181818;stroke-width:0.6667;"></polygon><text fill="#000000" font-family="sans-serif" font-size="8.6667" lengthAdjust="spacing" textLength="79.6901" x="977.3333" y="734.0313">output generates</text></g><!--link Client to RS--><g id="link_Client_RS"><path codeline="91" d="M150.42,631.3133 C208.0733,596.1 297.54,544.4667 380,509.4333 C409.58,496.8667 441.5533,485.22 473.0533,474.78 " fill="transparent" id="Client-RS" style="stroke:#181818;stroke-width:0.6667;"></path><text fill="#000000" font-family="sans-serif" font-size="8.6667" lengthAdjust="spacing" textLength="166.4955" x="193.3333" y="518.0313">sends request to/receives response from</text><text fill="#000000" font-family="sans-serif" font-size="8.6667" lengthAdjust="spacing" textLength="4.9573" x="155.7601" y="637.8472">1</text><text fill="#000000" font-family="sans-serif" font-size="8.6667" lengthAdjust="spacing" textLength="4.9573" x="450.1778" y="489.5556">1</text></g><!--link GMN30 to RS--><g id="link_GMN30_RS"><path d="M637.8733,240.7067 C562.9733,219.7067 369.1667,178.5667 276.3333,282.4333 C223.3733,341.6933 288.5133,375.5667 379.9533,394.9267 " fill="transparent" id="GMN30-RS" style="stroke:#181818;stroke-width:0.6667;stroke-dasharray:7.0,7.0;"></path></g><!--link GMN33 to ContentHashGenerator--><g id="link_GMN33_ContentHashGenerator"><path d="M599.5933,329.04 C498.6533,323.3133 317.7733,320.0733 276.3333,366.4333 C194.9867,457.4533 198.08,547.4067 276.3333,641.1 C348.3733,727.3667 486.9067,732.72 578.4867,725.1267 " fill="transparent" id="GMN33-ContentHashGenerator" style="stroke:#181818;stroke-width:0.6667;stroke-dasharray:7.0,7.0;"></path></g><!--link GMN36 to ContentIntegrityVerification--><g id="link_GMN36_ContentIntegrityVerification"><path d="M1148.4067,190.74 C1099.1867,192.2867 1042.1667,204 1009.6667,244.4333 C947.6667,321.5667 974.0333,374.7733 1009.6667,467.1 C1048.3,567.2 1146.64,652.2733 1201.6267,693.9667 " fill="transparent" id="GMN36-ContentIntegrityVerification" style="stroke:#181818;stroke-width:0.6667;stroke-dasharray:7.0,7.0;"></path></g><!--link GMN39 to ContentDecryption--><g id="link_GMN39_ContentDecryption"><path d="M604.52,287.3267 C504.6467,281.4333 318.4533,277.3067 276.3333,324.4333 C231.9067,374.14 235.8333,421.48 276.3333,474.4333 C347.9867,568.1133 493.3267,584.7733 585.4933,585.0667 " fill="transparent" id="GMN39-ContentDecryption" style="stroke:#181818;stroke-width:0.6667;stroke-dasharray:7.0,7.0;"></path></g><!--link GMN42 to ContentEncKeyDecryption--><g id="link_GMN42_ContentEncKeyDecryption"><path d="M1196.2,146.7533 C1142.3867,138.26 1053.24,134.2267 1009.6667,188.4333 C979.22,226.3067 982.78,257.2933 1009.6667,297.7667 C1026.4933,323.1 1051.3667,341.8267 1078.62,355.6733 " fill="transparent" id="GMN42-ContentEncKeyDecryption" style="stroke:#181818;stroke-width:0.6667;stroke-dasharray:7.0,7.0;"></path></g><!--link GMN48 to AuthorizationAssessment--><g id="link_GMN48_AuthorizationAssessment"><path d="M1196.2,104.7533 C1142.3867,96.26 1053.24,92.2267 1009.6667,146.4333 C992.7733,167.4467 993.3333,185.6467 1009.6667,207.1 C1041.94,249.4933 1099.7733,265.3867 1149.4533,270.7 " fill="transparent" id="GMN48-AuthorizationAssessment" style="stroke:#181818;stroke-width:0.6667;stroke-dasharray:7.0,7.0;"></path></g><!--SRC=[hLR1Rjiu4BthAmR9nLx4IPkYFHZP0Ahi9aQHRc6dkIpsm4WJcuXCQaagg5lqttT8YHObIqbGxCKMnPbvmpSpJzGfon7Epzv5EJuOC18KNsyCP5nXQhWKaNxaec2ARI7DcTQnCOhVbmONgHGh_WFXJTVa8qiVrqgM8ajaBXKSp-VpZxCaYjmk93b7OU1d132Pm3wUfXMzOccAMj_AHnHJY9j5PVrNWOhPj6fhBhZXpE0CKxKhxCPe7FtoIClL4CgMQOFgC-wcSECVONJxzGREJz-C-x5GE8n42aFvpqLAFgCqN9r0gL4jiXFW6RtaPlT5YXIRPHpFnbFusN9AUB51PV2xQUmMTosVMxR-HGba-582OQmNKkb0TF4epHOEmJ-nd6V4TLoQZLJyX-Dc5DIBVBvPq9cjG45DmDO8HtMv4xajfA0dVGJ7kUsn-xn4Lv-wBIguQwOtLoWizTGwThktWDGe-PgoC9ijjOb_X3_X-YPE9glhU7B-_eEpIvkuhjxtEuD__-FZTeiCiAx0CSXdLEIC2qlhEF2dGtPoNz3lcXBPtQ7Y3pnrWPip768zMRjTrxk1EmcpjzXIviX4BtWp0h_1MZnVMS8coUqo9AsgVOkpUcTnzpAJxO7f9x7RrQDqty9jhiEMehb-RJjL9_XVkBbARfoP7nHFpgArRfbqM0f6REWzZTwhYJqO_rTfIwCdU-wVrP4NTI5enUlFiq-_CxFavlRxP7cOXeocvmdRz8ywSbUfuBYdIa7QBKMBjIP1s_fFr00sgrrmYV-Mg4s_3jQDMqlWPF97lyfDRPgwnwnVK0RDWpQlRI8QbS3WO1fgizhAbQ_zQeWQ7_yGcUWQG8kUFLNZro8d6agTx5tV36NeztjIF3szz5XVlIZHYIukP6cAqbnUxZy2EkejM11Wg4H1i4B99sfBFNYK85ohDdqnVDcFtXxP8ze_AjKKD8fCWwgwaUvnPtH_GneF-qwJL6g41oMtKIIaGTelG3xugzWKbbYGcPLJC1lqx-EYoFs9blJbQVawr8xV4hKiLOgmGaNVDXZHEHKNQvYG-VdPSlLkV1XeO2IkV0bWGplMq2BKCjKNOAWIrHAh3Batiewr_67sNDXMHUg5zWxGVAxwV7lcRH-XDe6vsE_QI-X0m7eqPqxoz5xDkjwsnBLqWhkGxWs5rKDW8dFQ12HEOVZXCQyM1Cb24xXdccYZX-gA3axuN7ZANB6K3kXn_WC0]--></g></svg></p><div style="break-after:page"></div>
<p><strong>Explanation of the Class Diagrams and Assumptions Made:</strong></p>
<ul>
<li><strong>Classes Represent Participants:</strong> Each "participant" in the sequence diagrams is generally transformed into a class.</li>
<li><strong>Packages for Client and RS Components:</strong>  I've grouped the components into "Client Components" and "RS Components" packages to visually separate client-side and server-side classes.</li>
<li><strong>Attributes (Inferred):</strong>  I've added attributes to classes where it seemed logical based on their function. For example:
<ul>
<li>Encryption classes (<code>ContentEncryption</code>, <code>ContentEncKeyEncryption</code>) have <code>algorithm</code> attributes to specify the cryptographic algorithm used.</li>
<li><code>HKDF</code> and <code>ContentHashGenerator</code> also have <code>algorithm</code> attributes.</li>
<li><code>RS</code> class is shown with <code>masterKey</code>.</li>
<li><code>Client</code> class in Decryption diagram has <code>accessToken</code>.</li>
</ul>
</li>
<li><strong>Operations/Methods (Inferred):</strong> I've added operations (methods) to each class based on the actions they perform in the sequence diagrams. For example:
<ul>
<li><code>ContentHashGenerator</code> has <code>generateContentHash()</code>.</li>
<li><code>ContentEncryption</code> has <code>encryptContent()</code> and <code>decryptContent()</code>.</li>
<li><code>HKDF</code> has <code>deriveIdentityEncKey()</code>.</li>
<li><code>ContentEncKeyEncryption</code> has <code>encryptKey()</code> and <code>decryptKey()</code>, and methods to generate nonces/IVs.</li>
<li><code>RS</code> class has high-level operations <code>encryptContentEncKey()</code> and <code>decryptContentEncKey()</code> to represent the overall server-side encryption and decryption processes, and <code>validateAuthorization()</code>.</li>
</ul>
</li>
<li><strong>Relationships (Inferred and Defined):</strong>
<ul>
<li><strong>Composition/Aggregation ( <code>-*</code> ):</strong> I've used composition/aggregation ( <code>-*</code> ) to indicate that <code>Client</code> and <code>RS</code> <em>use</em> or <em>contain</em> the component classes within their respective packages. This is a general "uses" relationship.</li>
<li><strong>Association/Dependency ( <code>--&gt;</code> ):</strong> I've used association/dependency ( <code>--&gt;</code> ) to show relationships between components where one component uses another (e.g., <code>ContentHashGenerator</code> uses <code>ContentHashKeyRNDGenerator</code>).</li>
<li><strong>Output/Input ( <code>..&gt;</code> with Stereotype <code>&lt;&lt;output&gt;&gt;</code> ):</strong> I've used dashed arrows with the <code>&lt;&lt;output&gt;&gt;</code> stereotype to indicate data flow and outputs of operations, linking operations to metadata or data participants (e.g., <code>ContentEncryption ..&gt; ContentCiphertext : &lt;&lt;output&gt;&gt; generates</code>).</li>
<li><strong>Client-RS Interaction ( <code>Client "1" -- "1" RS</code> ):</strong> I've added a simple association between <code>Client</code> and <code>RS</code> to represent the client-server interaction, although in a more detailed diagram, this could be further refined (e.g., using interfaces or more specific associations).</li>
</ul>
</li>
<li><strong>Notes and Stereotypes:</strong> I've added notes to describe each class and stereotypes (like <code>&lt;&lt;output&gt;&gt;</code>) to clarify the meaning of relationships.</li>
</ul>

      </div>
      
      
    
    
    
    
    
    
  
    </body></html>